(self["webpackChunk_projuris_justto_web"]=self["webpackChunk_projuris_justto_web"]||[]).push([[2326,805],{42326:function(e,t,c){"use strict";c.r(t),c.d(t,{default:function(){return p}});var n=function(){var e=this,t=e._self._c;return e.lastMessage.disputeId===e.id||e.localLoading?t("section",{directives:[{name:"loading",rawName:"v-loading",value:e.localLoading,expression:"localLoading"}],ref:"occurrence-root",staticClass:"occurrences-container"},[t("div",{ref:"scroolContainer",staticClass:"occurrences-container__occurrences"},[e.filter.page>1?t("JusScrollLoading",{attrs:{target:e.scrollTarget,loading:e.localLoading,ended:e.isInLastPage,empty:Boolean(0===e.occurrences.length),reverse:"","empty-text":"Sem mensagens","end-text":"InÃ­cio das mensagens"},on:{"update:loading":function(t){e.localLoading=t},load:e.loadOccurrences}}):e._e(),e._l(e.occurrences,(function(e,c){return t(null===e.id?"Date":"Occurrence",{key:`occurrence-container-${c}`,tag:"component",staticClass:"occurrences-container__occurrences-item",attrs:{value:e}})})),"MESSAGES"===e.activeTab?t("dispute-tips",{attrs:{value:e.dispute}}):e._e()],2)]):t("section",{staticClass:"occurrences-container"},[t("div",{staticClass:"occurrences-container__omnichannel-error"},[t("el-button",{attrs:{type:"primary",size:"small",plain:""},on:{click:e.resetTicket}},[e._v(" Click aqui para ver mensagens ")])],1)])},r=[],s=c(90408),i=c(40917),o=c(32715),a=c(805),u={components:{Date:()=>c.e(5321).then(c.bind(c,35321)),Occurrence:a["default"],DisputeTips:()=>c.e(546).then(c.bind(c,60546)),JusScrollLoading:()=>c.e(4289).then(c.bind(c,24289))},data:()=>({needScroll:!1,localLoading:!1,scrollTarget:".occurrences-container.omnichannel-container__occurrences"}),computed:{...(0,s.Se)({activeTab:"getActiveTab",ticket:"getTicketOverview",filter:"getOccurrencesFilter",isLoading:"isOccurrencesLoading",occurrencesList:"getOccurrencesList",occurrencesListSorted:"getOccurrencesListSorted",messageType:"getEditorMessageType",isPrinting:"getExportTicketModalVisible",backups:"getMessagesBackupById",recipients:"getEditorRecipients",autodetectRecipient:"workspaceAutodetectRecipient",totalOfOccurrences:"getTotalOccurrences",isInLastPage:"getOccurrencesIsInLastPage"}),infiniteLoadingIdentifier(){return`${this.activeTab}-${this.id}`},countRendereds(){return this.occurrences.filter((e=>e.renderCompleted||e.interaction&&e.interaction.countRendereds)).length},id(){return Number(this.$route.params.id)},occurrences(){return("OCCURRENCES"===this.activeTab?this.occurrencesListSorted:this.occurrencesList).filter((({disputeId:e})=>[null,this.id].includes(e)))},dispute(){return{...this.ticket,id:this.id,disputeRoles:[],hasDocument:this.ticket.hasDraft,signStatus:this.ticket.draftStatus}},lastMessage(){const e=this.occurrences.filter((({id:e})=>e));return e[this.occurrences.length-1]||{disputeId:this.id}}},watch:{"$route.params.id"(){this.routeUpdate()},countRendereds(){this.adjustScroll()},activeTab(){this.resetTicket(this.id),this.adjustScroll(!0)}},mounted(){i.YB.$on("NEGOTIATION_WEBSOCKET_NEW_OCCURRENCE",(()=>{this.needScroll=!0})),i.YB.$on(o["default"].TICKET_CHANGE.callback,this.resetTicket),this.loadOccurrences((()=>{this.resetTicket(this.id),this.adjustScroll(!0)}))},updated(){this.needScroll&&this.adjustScroll()},beforeDestroy(){i.YB.$off("NEGOTIATION_WEBSOCKET_NEW_OCCURRENCE"),i.YB.$off(o["default"].TICKET_CHANGE.callback,this.resetTicket)},methods:{...(0,s.nv)(["resetNoteText","setMessageType","getOccurrences","resetRecipients","resetOccurrences","resetMessageText","addRecipient","autodetectTicketRecipients"]),adjustScroll(e=!1){if(this.filter.page<=2||e){const e=document.getElementsByClassName("occurrences-container omnichannel-container__occurrences")[0];e.scrollTo({top:e.scrollHeight}),i.YB.$emit("adjustScroll",{id:this.id})}},loadOccurrences(e){const t=document.querySelector(this.scrollTarget),c=t?.scrollHeight-t?.scrollTop;this.isPrinting||this.getOccurrences(this.id).then((n=>{n.first?this.adjustScroll(!0):t&&t.scroll(0,document.querySelector(this.scrollTarget)?.scrollHeight-c),e()})).finally(this.autodetectTicketRecipients)},routeUpdate(){this.resetTicket(this.id)},resetTicket(e){this.resetRecipients(),this.resetOccurrences(),this.resetMessageText(),this.resetNoteText(),this.lastMessage.disputeId===e&&this.occurrences.length||this.getOccurrences(e),this.localLoading=!1}}},l=u,d=(c(46953),c(1001)),A=(0,d.Z)(l,n,r,!1,null,"6c58721a",null),p=A.exports},805:function(e,t,c){"use strict";c.r(t),c.d(t,{default:function(){return u}});var n=function(){var e=this,t=e._self._c;return t("section",{staticClass:"occurrence-container",attrs:{id:`occurrence${e.value.id}`}},[t(e.component,e._b({tag:"component",attrs:{value:e.occurrence}},"component",e.childProps,!1))],1)},r=[],s={name:"Occurrence",components:{LOG:()=>c.e(6876).then(c.bind(c,6876)),NOTE:()=>c.e(1617).then(c.bind(c,61617)),INTERACTION:()=>c.e(3494).then(c.bind(c,53494))},props:{value:{type:Object,required:!0},childProps:{type:Object,default:()=>({})}},data:()=>({summaryTypes:["EMAIL","WHATSAPP","SMS"]}),computed:{occurrence:{get(){return this.value}},component(){const e={NOTE:["NOTE"],LOG:["LOG","CLICK","ACTION","TAP_WORKFLOW","VISUALIZATION","NEGOTIATOR_ACCESS"],SUMMARY:["SUMMARY"],INTERACTION:["INTERACTION"]},t=this.occurrence.type,c=this.occurrence.interaction?.type||"LOG";return Object.keys(e).find((n=>e[n].includes(t)||e[n].includes(c)))}}},i=s,o=c(1001),a=(0,o.Z)(i,n,r,!1,null,null,null),u=a.exports},17416:function(e,t,c){"use strict";c.r(t);var n=c(87537),r=c.n(n),s=c(23645),i=c.n(s),o=i()(r());o.push([e.id,".occurrences-container[data-v-6c58721a]{overflow-y:auto}.occurrences-container .infinite-loading-container>.infinite-status-prompt>div[data-v-6c58721a]{color:#979797!important;font-style:italic}.occurrences-container .occurrences-container__occurrences[data-v-6c58721a]{display:flex;flex-direction:column}.occurrences-container .occurrences-container__occurrences .occurrences-container__occurrences-date[data-v-6c58721a]{top:10px;text-align:center;z-index:10;position:sticky;width:80%;margin:18px 10% 10px}.occurrences-container .occurrences-container__occurrences .occurrences-container__occurrences-date span[data-v-6c58721a]{background-color:#e3f5ff;padding:10px}.occurrences-container .occurrences-container__omnichannel-error[data-v-6c58721a]{display:flex;height:100%;width:100%;justify-content:center;align-items:center}","",{version:3,sources:["webpack://./src/views/main/negotiation/partials/ticket/omnichannel/occurrences/Occurrences.vue"],names:[],mappings:"AAGA,wCACE,eAAA,CAEA,gGACE,uBAAA,CACA,iBAAA,CAGF,4EACE,YAAA,CACA,qBAAA,CAEA,qHACE,QAAA,CACA,iBAAA,CACA,UAAA,CAEA,eAAA,CACA,SAAA,CAEA,oBAAA,CAEA,0HACE,wBAAA,CACA,YAAA,CAKN,kFACE,YAAA,CACA,WAAA,CACA,UAAA,CACA,sBAAA,CACA,kBAAA",sourcesContent:["\n@import '~projuris-acordos-theme/src/common/colors.scss';\n\n.occurrences-container {\n  overflow-y: auto;\n\n  .infinite-loading-container > .infinite-status-prompt > div {\n    color: #979797 !important;\n    font-style: italic;\n  }\n\n  .occurrences-container__occurrences {\n    display: flex;\n    flex-direction: column;\n\n    .occurrences-container__occurrences-date {\n      top: 10px;\n      text-align: center;\n      z-index: 10;\n      position: -webkit-sticky;\n      position: sticky;\n      width: 80%;\n\n      margin: 18px 10% 10px;\n\n      span {\n        background-color: #e3f5ff;\n        padding: 10px;\n      }\n    }\n  }\n\n  .occurrences-container__omnichannel-error {\n    display: flex;\n    height: 100%;\n    width: 100%;\n    justify-content: center;\n    align-items: center;\n  }\n}\n"],sourceRoot:""}]),t["default"]=o},46953:function(e,t,c){var n=c(17416);n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);var r=c(39185).Z;r("a084f180",n,!0,{sourceMap:!0,shadowMode:!1})}}]);
//# sourceMappingURL=2326.js.map