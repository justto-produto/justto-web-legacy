(self["webpackChunk_projuris_justto_web"]=self["webpackChunk_projuris_justto_web"]||[]).push([[5130],{65130:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return c}});var i=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{"close-on-click-modal":!1,visible:e.editDisputeDialogVisible,"custom-class":"dispute-form-dialog",title:"Editar disputa",width:"70%"},on:{"update:visible":function(t){e.editDisputeDialogVisible=t}}},[e.editDisputeDialogVisible?t("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.editDisputeDialogLoading,expression:"editDisputeDialogLoading"}],ref:"disputeForm",attrs:{model:e.disputeForm,rules:e.disputeFormRules,"label-position":"top"},nativeOn:{submit:function(t){return t.preventDefault(),e.handleEditDispute.apply(null,arguments)}}},[t("h3",[e._v("Detalhes da Disputa")]),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"Número do Processo",prop:"disputeCode"}},[t("el-input",{directives:[{name:"mask",rawName:"v-mask",value:["XXXXXXX-XX.XXXX.X.XX.XXXX","XXXXXXX-XX.XXXX.X.XX.XXXXX"],expression:"['XXXXXXX-XX.XXXX.X.XX.XXXX', 'XXXXXXX-XX.XXXX.X.XX.XXXXX']"}],model:{value:e.disputeForm.disputeCode,callback:function(t){e.$set(e.disputeForm,"disputeCode",t)},expression:"disputeForm.disputeCode"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"Código interno",prop:"externalId"}},[t("el-input",{model:{value:e.disputeForm.externalId,callback:function(t){e.$set(e.disputeForm,"externalId",t)},expression:"disputeForm.externalId"}})],1)],1)],1),t("h3",[e._v("Engajamento")]),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"Estratégia",prop:"disputeStrategy"}},[t("el-select",{attrs:{placeholder:"Escolha a nova estratégia",filterable:"","data-testid":"strategy-input"},model:{value:e.selectedStrategyId,callback:function(t){e.selectedStrategyId=t},expression:"selectedStrategyId"}},[e._l(e.strategies,(function(e,a){return t("el-option",{key:`${e.id}-${a}`,attrs:{label:e.name,value:e.id,disabled:e.disabled||!1}})})),e.isValidStrategie?e._e():t("el-option",{attrs:{value:e.dispute.strategyId,label:"A estratégia utilizada não está mais disponível para uso",selected:"",disabled:""}})],2)],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{staticClass:"dispute-overview-view__select-switch",attrs:{span:24}},[t("div",{staticClass:"content"},[t("div",[e._v("Sempre engajar o autor")]),t("p",[e._v("Deixando "),t("b",[e._v("selecionada")]),e._v(" esta opção, "),t("b",[e._v("sempre")]),e._v(" iremos enviar mensagens automáticas para o autor.")])]),t("el-switch",{on:{input:function(t){return e.$forceUpdate()}},model:{value:e.disputeForm.alwaysContactParty,callback:function(t){e.$set(e.disputeForm,"alwaysContactParty",t)},expression:"disputeForm.alwaysContactParty"}})],1),t("el-tooltip",{attrs:{content:"Sempre engaja autor está habilitado",disabled:!e.disputeForm.alwaysContactParty}},[t("el-col",{staticClass:"dispute-overview-view__select-switch",style:e.disputeForm.alwaysContactParty?"cursor: not-allowed":"",attrs:{span:24}},[t("div",{staticClass:"content"},[t("div",[e._v("Engajar autor se não tiver advogado")]),t("p",[e._v(" Deixando "),t("b",[e._v("selecionada")]),e._v(" esta opção, iremos enviar mensagens para o autor quando não houver advogado constituído. ")])]),t("el-switch",{attrs:{disabled:e.disputeForm.alwaysContactParty},model:{value:e.disputeForm.contactPartyWhenNoLowyer,callback:function(t){e.$set(e.disputeForm,"contactPartyWhenNoLowyer",t)},expression:"disputeForm.contactPartyWhenNoLowyer"}})],1)],1),t("el-tooltip",{attrs:{content:"Sempre engaja autor está habilitado",disabled:!e.disputeForm.alwaysContactParty}},[t("el-col",{staticClass:"dispute-overview-view__select-switch",style:e.disputeForm.alwaysContactParty?"cursor: not-allowed":"",attrs:{span:24}},[t("div",{staticClass:"content"},[t("div",[e._v("Engajar autor se advogado não possuir contatos válidos para ser engajado")]),t("p",[e._v(" Deixando "),t("b",[e._v("selecionada")]),e._v(" esta opção, iremos enviar mensagens para o autor se o "),t("b",[e._v("advogado não possuir dados válidos")]),e._v(" para ser contatado. ")])]),t("el-switch",{attrs:{disabled:e.disputeForm.alwaysContactParty},model:{value:e.disputeForm.contactPartyWhenInvalidLowyer,callback:function(t){e.$set(e.disputeForm,"contactPartyWhenInvalidLowyer",t)},expression:"disputeForm.contactPartyWhenInvalidLowyer"}})],1)],1)],1),t("h3",[e._v("Valor proposto")]),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{rules:e.validateLastOfferValue(),label:"Valor",prop:"lastOfferValue"}},[t("el-tooltip",{attrs:{content:`${e.$tc("UPPER_RANGE",e.isRecoveryStrategy)} zerad${e.isRecoveryStrategy?"o":"a"}. Coloque um${e.isRecoveryStrategy?"":"a"} ${e.$tc("UPPER_RANGE",e.isRecoveryStrategy)} para poder alterar o valor proposto.`,disabled:!!e.disputeForm.disputeUpperRange}},[t("div",{staticClass:"el-input",class:{"is-disabled":!e.disputeForm.disputeUpperRange}},[t("money",{staticClass:"el-input__inner",attrs:{disabled:!e.disputeForm.disputeUpperRange,"data-testid":"proposal-value-input"},nativeOn:{change:function(t){e.lastOfferValueHasChanged=!0}},model:{value:e.disputeForm.lastOfferValue,callback:function(t){e.$set(e.disputeForm,"lastOfferValue",t)},expression:"disputeForm.lastOfferValue"}})],1)])],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"Proposto por",prop:"lastOfferValueName"}},[t("el-select",{attrs:{disabled:!e.disputeForm.disputeUpperRange,filterable:"",placeholder:"Autor da contraproposta","data-testid":"proposal-negotiator-input"},model:{value:e.selectedNegotiatorId,callback:function(t){e.selectedNegotiatorId=t},expression:"selectedNegotiatorId"}},e._l(e.disputeNegotiations,(function(e,a){return t("el-option",{key:`${a}-${e.id}`,attrs:{label:e.name,value:e.id}})})),1)],1)],1)],1),t("h3",[e._v("Outras configurações")]),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{rules:e.validateDisputeUpperRange(),label:e.$tc("UPPER_RANGE",e.isRecoveryStrategy),prop:"disputeUpperRange"}},[t("div",{staticClass:"el-input"},[t("money",{staticClass:"el-input__inner",attrs:{"data-testid":"bondary-input"},nativeOn:{blur:function(t){return e.checkZeroUpperRange.apply(null,arguments)},change:function(t){return e.disputeUpperRangeChangedHandler.apply(null,arguments)}},model:{value:e.disputeForm.disputeUpperRange,callback:function(t){e.$set(e.disputeForm,"disputeUpperRange",t)},expression:"disputeForm.disputeUpperRange"}})],1)])],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"Fim da negociação",prop:"expirationDate"}},[t("el-date-picker",{attrs:{clearable:!1,"data-testid":"expiration-date-input",format:"dd/MM/yyyy",type:"date","value-format":"yyyy-MM-dd"},model:{value:e.disputeForm.expirationDate,callback:function(t){e.$set(e.disputeForm,"expirationDate",t)},expression:"disputeForm.expirationDate"}})],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"Dano material",prop:"materialDamage"}},[t("div",{staticClass:"el-input"},[t("money",{staticClass:"el-input__inner",model:{value:e.disputeForm.materialDamage,callback:function(t){e.$set(e.disputeForm,"materialDamage",t)},expression:"disputeForm.materialDamage"}})],1)])],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"Dano moral",prop:"moralDamage"}},[t("div",{staticClass:"el-input"},[t("money",{staticClass:"el-input__inner",model:{value:e.disputeForm.moralDamage,callback:function(t){e.$set(e.disputeForm,"moralDamage",t)},expression:"disputeForm.moralDamage"}})],1)])],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"Valor do processo",prop:"requestedValue"}},[t("div",{staticClass:"el-input"},[t("money",{staticClass:"el-input__inner",model:{value:e.disputeForm.requestedValue,callback:function(t){e.$set(e.disputeForm,"requestedValue",t)},expression:"disputeForm.requestedValue"}})],1)])],1),t("el-col",{attrs:{span:6}},[t("el-form-item",{attrs:{label:"Valor provisionado",prop:"provisionedValue"}},[t("div",{staticClass:"el-input"},[t("money",{staticClass:"el-input__inner",model:{value:e.disputeForm.provisionedValue,callback:function(t){e.$set(e.disputeForm,"provisionedValue",t)},expression:"disputeForm.provisionedValue"}})],1)])],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"Classificação",prop:"classification"}},[t("el-input",{model:{value:e.disputeForm.classification,callback:function(t){e.$set(e.disputeForm,"classification",t)},expression:"disputeForm.classification"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"Subclassificação",prop:"classificationDetails"}},[t("el-select",{staticClass:"el-input",attrs:{multiple:"",filterable:"","allow-create":""},model:{value:e.disputeForm.classificationDetails,callback:function(t){e.$set(e.disputeForm,"classificationDetails",t)},expression:"disputeForm.classificationDetails"}},e._l(e.subClassifications,(function(e,a){return t("el-option",{key:`sub-classification-${a}`,attrs:{label:e.name,value:a}})})),1)],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"Descrição",prop:"description"}},[t("el-input",{attrs:{type:"textarea",rows:"3","data-testid":"description-input"},model:{value:e.disputeForm.description,callback:function(t){e.$set(e.disputeForm,"description",t)},expression:"disputeForm.description"}})],1)],1)],1)],1):e._e(),t("span",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{plain:""},on:{click:function(t){return e.hide()}}},[e._v(" Cancelar ")]),t("el-button",{attrs:{loading:e.editDisputeDialogLoading,type:"primary","data-testid":"confirm-edit-data"},on:{click:e.handleEditDispute}},[e._v(" Editar dados ")])],1)],1)},s=[],o=(a(57658),a(18814)),r=a(40917),l=a(90408),n={props:{loading:{type:Boolean,default:!1}},data(){return{editDisputeDialogVisible:!1,editDisputeDialogLoading:!1,disputeUpperRangeHasChanged:!1,lastOfferValueHasChanged:!1,selectedClaimantId:"",selectedStrategyId:"",selectedNegotiatorId:"",disputeForm:{description:"",expirationDate:"",disputeUpperRange:"",lastOfferValue:"",classification:"",contactPartyWhenNoLowyer:!1,contactPartyWhenInvalidLowyer:!1,denySavingDeposit:!1,disputeCode:"",zeroUpperRange:!1,materialDamage:"",moralDamage:"",requestedValue:"",externalId:"",provisionedValue:"",classificationDetails:[]},disputeFormRules:{disputeUpperRange:[{required:!0,message:"Campo obrigatório",trigger:"submit"}],lastOfferValue:[{required:!0,message:"Campo obrigatório",trigger:"submit"}]},subClassifications:[],dispute:{},strategies:[]}},computed:{...(0,l.Se)({isRecoveryStrategy:"isWorkspaceRecovery"}),isValidStrategie(){return(this.strategies||[]).map((e=>e.id)).includes(this.dispute.strategyId)},disputeNegotiations(){return this.dispute?.disputeRoles?(0,r.F3)(this.dispute.disputeRoles,"RESPONDENT","NEGOTIATOR"):[]}},methods:{...(0,l.nv)({setDispute:"editDispute",getDispute:"getDispute",getStrategies:"getMyStrategiesLite",getTicketOverviewInfo:"getTicketOverviewInfo",setSubclassifications:"setDisputeClassificationsDetails"}),show(){this.$route?.params?.id&&(this.editDisputeDialogLoading=!0,this.getDispute(Number(this.$route.params.id)).then((e=>{this.dispute=e,this.selectedStrategyId=e.strategyId||"",this.subClassifications=e?.classification?.classificationDetails||[],this.getStrategies().then((e=>{this.strategies=e,e.map((({id:e})=>e)).includes(this.selectedStrategyId)||this.strategies.push({id:this.dispute.strategyId,name:"A estratégia utilizada não está mais disponível para uso",disabled:!0})}))})).finally((()=>{this.editDisputeDialogVisible=!0,this.handleOpenDialog()})))},hide(){this.editDisputeDialogVisible=!1,this.editDisputeDialogLoading=!1,this.$refs.disputeForm.clearValidate(),this.$emit("hide")},handleOpenDialog(){this.disputeForm={id:this.dispute?.id,disputeCode:this.dispute?.code,disputeUpperRange:parseFloat(this.dispute?.disputeUpperRange),lastOfferValue:parseFloat(this.dispute?.lastOfferValue),expirationDate:this.dispute?.expirationDate?.dateTime,description:this.dispute?.description||"",materialDamage:this.dispute?.materialDamage||"",moralDamage:this.dispute?.moralDamage||"",requestedValue:this.dispute?.requestedValue||"",externalId:this.dispute?.externalId||"",provisionedValue:this.dispute?.provisionedValue||"",classification:this.dispute?.classification?.name||"",contactPartyWhenNoLowyer:Boolean(this.dispute?.contactPartyWhenNoLowyer),contactPartyWhenInvalidLowyer:Boolean(this.dispute?.contactPartyWhenInvalidLowyer),alwaysContactParty:Boolean(this.dispute?.alwaysContactParty),denySavingDeposit:Boolean(this.dispute?.denySavingDeposit),zeroUpperRange:!parseFloat(this.dispute?.disputeUpperRange),classificationDetails:(this.dispute?.classification?.classificationDetails||[]).map((({_:e},t)=>t))},this.selectedNegotiatorId=this.disputeNegotiations?.length?this.disputeNegotiations[0].id:"",this.disputeUpperRangeHasChanged=!1,this.lastOfferValueHasChanged=!1,this.editDisputeDialogLoading=!1,this.$nextTick((()=>{this.$refs.disputeForm.clearValidate()}))},handleEditDispute(){this.$refs.disputeForm.validate((e=>{if(e){this.editDisputeDialogLoading=!0;const e=this.$createElement,t=this.isRecoveryStrategy?this.disputeForm.lastOfferValue<this.disputeForm.disputeUpperRange:this.disputeForm.lastOfferValue>this.disputeForm.disputeUpperRange,a=`- ${this.$tc("UPPER_RANGE",this.isRecoveryStrategy)} está ${this.isRecoveryStrategy?"acima":"abaixo"} do valor proposto.`;this.$msgbox({title:"Atenção!",message:e("p",null,[e("div",null,"- As novas informações vão sobrescrever as antigas."),t?e("div",null,a):null,e("br",null,null),e("div",null,"Deseja continuar?")]),confirmButtonText:"Continuar",confirmButtonClass:"edit-case-confirm-button",showCancelButton:!0,customClass:"edit-case-confitm-dialog"}).then(this.editDispute).catch((()=>{this.editDisputeDialogLoading=!1}))}}))},editDispute(){const e={...JSON.parse(JSON.stringify(this.dispute)),strategyId:this.selectedStrategyId,code:this.disputeForm?.disputeCode,description:this.disputeForm?.description,lastOfferRoleId:this.selectedNegotiatorId,lastOfferValue:this.disputeForm?.lastOfferValue,externalId:this.disputeForm?.externalId||null,moralDamage:this.disputeForm?.moralDamage||null,provisionedValue:this.disputeForm?.provisionedValue,denySavingDeposit:this.disputeForm?.denySavingDeposit,disputeUpperRange:this.disputeForm?.disputeUpperRange,materialDamage:this.disputeForm?.materialDamage||null,requestedValue:this.disputeForm?.requestedValue||null,alwaysContactParty:this.disputeForm?.alwaysContactParty,classification:{name:this.disputeForm?.classification||"",classificationDetails:[...this.disputeForm?.classificationDetails.map((e=>Number.isInteger(e)?this.subClassifications[e]:{name:e}))]},contactPartyWhenNoLowyer:this.disputeForm?.contactPartyWhenNoLowyer,contactPartyWhenInvalidLowyer:this.disputeForm?.contactPartyWhenInvalidLowyer,expirationDate:{dateTime:this.$moment(this.disputeForm?.expirationDate).endOf("day").format("YYYY-MM-DD[T]HH:mm:ss[Z]")}};this.editDisputeDialogLoading=!1,this.dispute?.expirationDate?.dateTime||this.$jusNotification({title:"Ops!",message:`Disputa sem ${this.$tc("dispute.expirationDate")}.`,type:"warning"});const t=this.dispute.expirationDate.dateTime,a=e.expirationDate.dateTime;this.setDispute(e).then((()=>{this.$jusSegment("Editar disputa",{disputeId:e.id}),this.$jusNotification({title:"Yay!",message:"Os dados foram alterados com sucesso.",type:"success"}),this.$nextTick().then((()=>this.$emit("fetch-data"))),this.getTicketOverviewInfo(e.id),this.getDispute(e.id),this.hide(),this.handleResendMessagesOnEdit({...this.dispute,currentDate:t,newDate:a})})).catch(this.handleSetDisputeError).finally((()=>{this.editDisputeDialogLoading=!1}))},handleSetDisputeError(e){if(e.response&&e.response.data&&412===e.response?.status&&"DUPLICATED_VALIDATION"===e.response.data.code){const{CAN_ACCESS_OTHER:t,OTHER_DISPUTE_ID:a,OTHER_NEGOTIATORS:i}=e.response.data.fields,s=t?`Este número de processo ja está sendo usado na disputa <a target="_blank" href="https://acordos.projuris.com.br/#/management/dispute/${a}">#OTHER_DISPUTE_ID</a>.`:`Este número de processo ja está sendo usado na disputa <b>#${a}</b>. Você não possui acesso a essa disputa. Verifique com um negociador responsável: <b>${i}</b>`;this.$jusNotification({title:"Ops!",message:s,type:"warning",dangerouslyUseHTMLString:!0})}else this.$jusNotification({error:e})},handleResendMessagesOnEdit({currentDate:e,newDate:t,contactPartyWhenNoLowyer:a,contactPartyWhenInvalidLowyer:i,alwaysContactParty:s}){const o=this.$moment(e).isBefore(this.$moment())&&this.$moment(t).isSameOrAfter(this.$moment()),r=this.disputeForm.contactPartyWhenNoLowyer!==a,l=this.disputeForm.contactPartyWhenInvalidLowyer!==i,n=this.disputeForm.alwaysContactParty!==s,d=l||r||n,p="RUNNING"===this.dispute.status;if(d||o){const e=p?"reenviar mensagens automáticas":"reiniciar esta disputa",t=d?"As configurações de engajamento foram alteradas. Deseja "+e+"?":"A data de expiração foi alterada. Deseja "+e+"?";this.$confirm(t,"Atenção!",{confirmButtonText:p?"Reenviar":"Reiniciar",cancelButtonText:"Cancelar",type:"warning"}).then((()=>{this.$store.dispatch("sendDisputeAction",{action:p?"resend-messages":"restart-engagement",disputeId:this.dispute.id}).then((()=>{const e=p?"Reenvio de mensagens":"Reengajamento";this.$jusNotification({title:"Yay!",message:`${e} realizado com sucesso.`,type:"success"})}))}))}},disputeUpperRangeChangedHandler(){this.disputeUpperRangeHasChanged=!0,this.disputeForm.disputeUpperRange>0&&(this.disputeForm.lastOfferValue=this.disputeForm.disputeUpperRange)},validateLastOfferValue(){return this.lastOfferValueHasChanged&&this.disputeForm.disputeUpperRange?[{validator:o.ci,message:"Valor precisa ser acima de 0",trigger:"submit"}]:[]},validateDisputeUpperRange(){return this.disputeUpperRangeHasChanged?[{validator:o.ci,message:"Valor precisa ser acima de 0",trigger:"submit"}]:[]},checkZeroUpperRange(){this.disputeForm.zeroUpperRange&&this.$nextTick((()=>{this.$refs.disputeForm.validate()}))}}},d=n,p=(a(31997),a(1001)),u=(0,p.Z)(d,i,s,!1,null,null,null),c=u.exports},56196:function(e,t,a){"use strict";a.r(t);var i=a(87537),s=a.n(i),o=a(23645),r=a.n(o),l=r()(s());l.push([e.id,".dispute-form-dialog .el-dialog__body .el-form .el-row .dispute-overview-view__select-switch{display:flex;flex-direction:row;align-items:flex-end}.dispute-form-dialog .el-dialog__body .el-form .el-row .dispute-overview-view__select-switch .content{flex:1;word-break:keep-all}.dispute-form-dialog .el-dialog__body .el-form .el-row .dispute-overview-view__select-switch .content div{font-weight:600;padding-top:2px}.dispute-form-dialog .el-dialog__body .el-form .el-row .dispute-overview-view__select-switch .content p{font-style:italic;font-size:12px;margin:6px 20px 1em 0}.dispute-form-dialog .el-dialog__body .el-form .el-row .dispute-overview-view__select-switch .el-switch{margin-block-end:1em}","",{version:3,sources:["webpack://./src/components/dialogs/EditDisputeDialog.vue"],names:[],mappings:"AAKQ,6FACE,YAAA,CACA,kBAAA,CACA,oBAAA,CAEA,sGACE,MAAA,CACA,mBAAA,CAEA,0GACE,eAAA,CACA,eAAA,CAGF,wGACE,iBAAA,CACA,cAAA,CACA,qBAAA,CAIJ,wGACE,oBAAA",sourcesContent:["\n.dispute-form-dialog {\n  .el-dialog__body {\n    .el-form {\n      .el-row {\n        .dispute-overview-view__select-switch {\n          display: flex;\n          flex-direction: row;\n          align-items: flex-end;\n\n          .content {\n            flex: 1;\n            word-break: keep-all;\n\n            div {\n              font-weight: 600;\n              padding-top: 2px;\n            }\n\n            p {\n              font-style: italic;\n              font-size: 12px;\n              margin: 6px 20px 1em 0;\n            }\n          }\n\n          .el-switch {\n            margin-block-end: 1em;\n          }\n        }\n      }\n    }\n  }\n}\n"],sourceRoot:""}]),t["default"]=l},31997:function(e,t,a){var i=a(56196);i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);var s=a(39185).Z;s("b4009da8",i,!0,{sourceMap:!0,shadowMode:!1})}}]);
//# sourceMappingURL=5130.js.map