(self["webpackChunk_projuris_justto_web"]=self["webpackChunk_projuris_justto_web"]||[]).push([[528],{4884:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return c}});var i=function(){var e=this,t=e._self._c;return t("article",[e.visible?t("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.saving,expression:"saving"}],ref:"form",staticClass:"contract__form",attrs:{model:e.form,size:"mini"}},[t("el-row",{attrs:{gutter:8}},[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{prop:"tariffType",label:"Modelo de cobranÃ§a:"}},[t("el-select",{attrs:{placeholder:"Selecione..."},model:{value:e.form.tariffType,callback:function(t){e.$set(e.form,"tariffType",t)},expression:"form.tariffType"}},[t("el-option",{attrs:{value:"FRANCHISE",label:"Franquia"}}),t("el-option",{attrs:{value:"VOLUMETRY",label:"Volumetria"}})],1)],1)],1)],1),"FRANCHISE"===e.form.tariffType?t("el-row",{staticClass:"mb10",attrs:{gutter:8}},[e._l(e.franchiseTariffsOnForm,(function(r,i){return t("el-col",{key:`edit-tariff#${i}`,attrs:{span:24}},[t("el-form-item",{staticClass:"flex-item small-label",attrs:{label:e.franchiseTariffTypes[r.type].label}},[t("SingleTariffForm",{attrs:{"contract-inactive":e.isContractInactive},on:{delete:function(t){e.handleRemoveTariff(e.getTariffIndex(r.type))}},model:{value:e.form.tariffs[e.getTariffIndex(r.type)],callback:function(t){e.$set(e.form.tariffs,e.getTariffIndex(r.type),t)},expression:"form.tariffs[getTariffIndex(tariff.type)]"}})],1)],1)})),e.franchiseTariffsNotOnForm.length?t("el-col",{attrs:{span:24}},[t("TariffTypeDropdown",{attrs:{tariffs:e.franchiseTariffsNotOnForm},on:{command:e.handleAddTariff}})],1):e._e()],2):"VOLUMETRY"===e.form.tariffType?t("el-row",{staticClass:"mb10",attrs:{gutter:8}},[e._l(e.volumetryTariffsOnForm,(function(r,i){return t("el-col",{key:`edit-tariff#${i}`,attrs:{span:24}},[t("el-form-item",{staticClass:"flex-item small-label",attrs:{label:e.volumetryTariffTypes[r.type].label}},[t("SingleTariffForm",{attrs:{"contract-inactive":e.isContractInactive,type:e.form.tariffType},on:{delete:function(t){e.handleRemoveTariff(e.getTariffIndex(r.type))}},model:{value:e.form.tariffs[e.getTariffIndex(r.type)],callback:function(t){e.$set(e.form.tariffs,e.getTariffIndex(r.type),t)},expression:"form.tariffs[getTariffIndex(tariff.type)]"}})],1)],1)})),e.volumetryTariffsNotOnForm.length?t("el-col",{attrs:{span:24}},[t("TariffTypeDropdown",{attrs:{tariffs:e.volumetryTariffsNotOnForm},on:{command:e.handleAddTariff}})],1):e._e()],2):e._e(),t("el-row",[t("el-col",[t("el-form-item",{staticClass:"flex-end"},[t("el-button",{on:{click:e.handleCancel}},[e._v(" Cancelar ")]),t("el-button",{attrs:{type:"primary",disabled:e.saving},on:{click:e.handleSave}},[t("i",{directives:[{name:"show",rawName:"v-show",value:e.saving,expression:"saving"}],staticClass:"el-icon-loading"}),e._v(" Salvar ")])],1)],1)],1)],1):"FRANCHISE"===e.contract.tariffType?t("FranchiseTariffsDescription",{attrs:{tariffs:e.filteredFranchiseTariffs},on:{click:e.open}}):"VOLUMETRY"===e.contract.tariffType?t("VolumetryTariffsDescription",{attrs:{tariffs:e.filteredVolumetryTariffs},on:{click:e.open}}):e._e()],1)},n=[],l=(r(57658),r(66592)),f=r(90408),o={name:"EditTariffsForm",components:{SingleTariffForm:()=>r.e(8748).then(r.bind(r,28748)),TariffTypeDropdown:()=>r.e(7541).then(r.bind(r,97541)),FranchiseTariffsDescription:()=>r.e(6953).then(r.bind(r,76953)),VolumetryTariffsDescription:()=>r.e(8017).then(r.bind(r,38017))},props:{contract:{type:Object,required:!0},customer:{type:Object,required:!0}},data:()=>({visible:!1,saving:!1,form:{tariffType:"",tariffs:[]},franchiseTariffTypes:l.S7,franchiseTariffKeys:Object.keys(l.S7),volumetryTariffTypes:l.GS,volumetryTariffKeys:Object.keys(l.GS)}),computed:{isContractInactive(){return"INACTIVE"===this.contract?.status},contractDate(){return this.contract?.updateAt?.dateTime||this.contract?.createAt?.dateTime||(new Date).toISOString()},filteredTariffs(){return(this.contract.tariffs||[]).filter((({value:e})=>Boolean(e)))},filteredFranchiseTariffs(){return(this.contract.tariffs||[]).filter((({value:e,type:t})=>Boolean(e)&&this.franchiseTariffKeys.includes(t)))},filteredVolumetryTariffs(){return(this.contract.tariffs||[]).filter((({value:e,type:t})=>Boolean(e)&&this.volumetryTariffKeys.includes(t)))},haveTariffs(){return this.filteredTariffs.length>0},franchiseTariffsOnForm(){return this.form.tariffs.filter((({type:e})=>this.franchiseTariffKeys.includes(e)))},franchiseTariffsNotOnForm(){return this.franchiseTariffKeys.filter((e=>!this.franchiseTariffsOnForm.map((({type:e})=>e)).includes(e)))},volumetryTariffsOnForm(){return this.form.tariffs.filter((({type:e})=>this.volumetryTariffKeys.includes(e)))},volumetryTariffsNotOnForm(){return this.volumetryTariffKeys.filter((e=>!this.volumetryTariffsOnForm.map((({type:e})=>e)).includes(e)))},getTariffByKey(){return e=>(this.contract?.tariffs||[]).find((({type:t})=>t===e))||{type:e,value:0,volumeLimit:0}}},methods:{...(0,f.nv)(["updateContract"]),populateForm(){["tariffType","tariffs"].forEach((e=>{this.form[e]=this.contract[e]}))},populateTariffs(){this.form.tariffs=[...this.form.tariffs||[]]},open(){this.populateForm(),this.populateTariffs(),this.visible=!0},handleResetForm(){return this.form={tariffType:"",tariffs:[]},Promise.resolve()},handleClose(e){e(),this.visible=!1},handleCancel(){this.saving=!0,this.handleResetForm().finally((e=>{this.saving=!1,this.visible=!1}))},handleSave(){this.saving=!0,this.updateContract({customerId:this.customer.customerId,contract:{...this.contract,...this.form}}).then((async e=>{this.$jusNotification({type:"success",title:"Yay!",message:"Contrato editado com sucesso."}),this.handleCancel()})).catch((e=>{this.$jusNotification({error:e})})).finally((()=>{this.saving=!1}))},getTariffIndex(e){let t;return this.form.tariffs.map(((r,i)=>{if(r.type===e)return t=i})),t},handleAddTariff(e){this.form.tariffs.push({type:e,value:0,volumeLimit:1})},handleRemoveTariff(e){this.form.tariffs.splice(e,1)}}},a=o,s=(r(24875),r(1001)),m=(0,s.Z)(a,i,n,!1,null,null,null),c=m.exports},82324:function(e,t,r){"use strict";r.r(t);var i=r(87537),n=r.n(i),l=r(23645),f=r.n(l),o=f()(n());o.push([e.id,".contract__form .el-row .el-col .el-form-item.flex-item{display:flex;flex-direction:column;align-items:flex-start}.contract__form .el-row .el-col .el-form-item.flex-item .el-form-item__content{width:100%}.contract__form .el-row .el-col .el-form-item.flex-item .el-form-item__content .el-form--inline .el-row .el-col .el-form-item{width:100%!important;line-height:0}.contract__form .el-row .el-col .el-form-item.flex-item .el-form-item__content .el-form--inline .el-row .el-col .el-form-item .el-form-item__label{font-weight:400!important;line-height:1.5rem}.contract__form .el-row .el-col .el-form-item.flex-item .el-form-item__content .el-form--inline .el-row .el-col .el-form-item .el-form-item__content .el-input-number{width:100%!important}.contract__form .el-row .el-col .el-form-item.flex-item .el-form-item__content .el-form--inline .el-row .el-col .labelless .el-form-item__label{visibility:hidden}.contract__form .el-row .el-col .el-form-item.flex-item.small-label .el-form-item__label{font-size:1rem!important}.contract__form .el-row .el-col .el-form-item.flex-end{margin:0}.contract__form .el-row .el-col .el-form-item.flex-end .el-form-item__content{display:flex;justify-content:flex-end}.contract__form .el-row+.el-row .el-col .el-form-item.flex-item>.el-form-item__label{font-weight:600;font-size:1.25rem}","",{version:3,sources:["webpack://./src/views/main/billing/partials/partials/EditTariffsForm.vue"],names:[],mappings:"AAIM,wDACE,YAAA,CACA,qBAAA,CACA,sBAAA,CAEA,+EACE,UAAA,CAKM,8HACE,oBAAA,CACA,aAAA,CAEA,mJACE,yBAAA,CACA,kBAAA,CAIA,sKACE,oBAAA,CAMJ,gJACE,iBAAA,CASV,yFACE,wBAAA,CAKN,uDACE,QAAA,CAEA,8EACE,YAAA,CACA,wBAAA,CAQJ,qFACE,eAAA,CACA,iBAAA",sourcesContent:["\n.contract__form {\n  .el-row {\n    .el-col {\n      .el-form-item.flex-item {\n        display: flex;\n        flex-direction: column;\n        align-items: flex-start;\n\n        .el-form-item__content {\n          width: 100%;\n\n          .el-form--inline {\n            .el-row {\n              .el-col {\n                .el-form-item {\n                  width: 100% !important;\n                  line-height: 0;\n\n                  .el-form-item__label {\n                    font-weight: normal !important;\n                    line-height: 1.5rem;\n                  }\n\n                  .el-form-item__content {\n                    .el-input-number {\n                      width: 100% !important;\n                    }\n                  }\n                }\n\n                .labelless {\n                  .el-form-item__label  {\n                    visibility: hidden;\n                  }\n                }\n              }\n            }\n          }\n        }\n\n        &.small-label {\n          .el-form-item__label {\n            font-size: 1rem !important;\n          }\n        }\n      }\n\n      .el-form-item.flex-end {\n        margin: 0;\n\n        .el-form-item__content {\n          display: flex;\n          justify-content: flex-end;\n        }\n      }\n    }\n  }\n\n  .el-row + .el-row {\n    .el-col {\n      .el-form-item.flex-item > .el-form-item__label {\n        font-weight: 600;\n        font-size: 1.25rem;\n      }\n    }\n  }\n\n  .el-descriptions {\n    .el-descriptions__body {\n      .el-descriptions__table {\n        tbody {\n          .el-descriptions-row {\n            .el-descriptions-item {\n              .el-descriptions-item__container {}\n            }\n          }\n        }\n      }\n    }\n  }\n}\n"],sourceRoot:""}]),t["default"]=o},24875:function(e,t,r){var i=r(82324);i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);var n=r(39185).Z;n("0ccfc556",i,!0,{sourceMap:!0,shadowMode:!1})}}]);
//# sourceMappingURL=528.js.map