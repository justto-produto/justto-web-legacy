(self["webpackChunk_projuris_justto_web"]=self["webpackChunk_projuris_justto_web"]||[]).push([[5611],{45611:function(e,i,t){"use strict";t.r(i),t.d(i,{default:function(){return u}});var o=function(){var e=this,i=e._self._c;return i("section",{staticClass:"workspace-container"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticClass:"workspace-container__table",staticStyle:{width:"100%"},attrs:{data:e.filteredWorkspaces,height:"95vh"},on:{"row-click":e.handleRowClick}},[i("el-table-column",{attrs:{prop:"name",label:"Workspace"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.name)+" "),i("el-popover",{ref:"worspaceNameEditPopover",attrs:{title:"Editar",width:"auto",trigger:"click","popper-class":"worspace-name__edit"}},[i("i",{staticClass:"el-icon-edit",attrs:{slot:"reference"},slot:"reference"}),i("article",[i("el-input",{attrs:{size:"mini"},nativeOn:{keyup:function(i){return!i.type.indexOf("key")&&e._k(i.keyCode,"enter",13,i.key,"Enter")?null:e.handleEditWorkspace(t.row)}},model:{value:t.row.name,callback:function(i){e.$set(t.row,"name",i)},expression:"scope.row.name"}}),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(i){return e.handleEditWorkspace(t.row)}}},[e._v(" Salvar ")])],1)])]}}])}),i("el-table-column",{attrs:{prop:"teamName",label:"Equipe"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.teamName)+" "),i("el-popover",{ref:"worspaceTeamNameEditPopover",attrs:{title:"Editar",width:"auto",trigger:"click","popper-class":"worspace-name__edit"}},[i("i",{staticClass:"el-icon-edit",attrs:{slot:"reference"},slot:"reference"}),i("article",[i("el-input",{attrs:{size:"mini"},nativeOn:{keyup:function(i){return!i.type.indexOf("key")&&e._k(i.keyCode,"enter",13,i.key,"Enter")?null:e.handleEditWorkspace(t.row)}},model:{value:t.row.teamName,callback:function(i){e.$set(t.row,"teamName",i)},expression:"scope.row.teamName"}}),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(i){return e.handleEditWorkspace(t.row)}}},[e._v(" Salvar ")])],1)])]}}])}),i("el-table-column",{attrs:{align:"right",prop:"archived","class-name":"portifolios-column"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{staticClass:"portifolios-column__container"},[i("el-popover",{ref:"worspaceTeamNameEditPopover",attrs:{title:"Convidar",width:"auto",trigger:"click","popper-class":"worspace-name__edit"}},[i("el-button",{attrs:{slot:"reference",disabled:"READY"!==t.row.status,icon:"el-icon-plus",size:"mini",circle:""},slot:"reference"}),i("article",[i("label",{attrs:{for:"inviteForm__email"}},[e._v("E-mail")]),i("div",{staticClass:"el-input el-input--mini"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.inviteForm.email,expression:"inviteForm.email"}],staticClass:"el-input__inner",attrs:{id:"inviteForm__email",type:"email",name:"inviteForm__email"},domProps:{value:e.inviteForm.email},on:{input:[function(i){i.target.composing||e.$set(e.inviteForm,"email",i.target.value)},function(i){return e.$forceUpdate()}]}})]),i("label",[e._v("Perfil")]),i("el-select",{attrs:{size:"mini"},model:{value:e.inviteForm.profile,callback:function(i){e.$set(e.inviteForm,"profile",i)},expression:"inviteForm.profile"}},e._l(["NEGOTIATOR","ADMINISTRATOR"],(function(t){return i("el-option",{key:t,attrs:{label:e.$t("profile."+t).toUpperCase(),value:t}})})),1),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(i){return e.handleInviteEmail(t.row)}}},[e._v(" Convidar ")])],1)],1),i("el-switch",{attrs:{value:"READY"===t.row.status},on:{change:function(i){return e.handleArchiveWorkspace(i,t.row)}}})],1)}}])},[e.hideSearch?e._e():i("template",{slot:"header"},[i("div",{staticClass:"el-input el-input--mini"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.search,expression:"search"}],staticClass:"el-input__inner",attrs:{placeholder:"Pesquise aqui"},domProps:{value:e.search},on:{input:[function(i){i.target.composing||(e.search=i.target.value)},function(i){return e.$forceUpdate()}]}})])])],2)],1),i("el-dialog",{attrs:{title:"Tipos de carteira",visible:e.dialog.visible,"append-to-body":"","custom-class":"portifolios-dialog"},on:{"update:visible":function(i){return e.$set(e.dialog,"visible",i)}}},[i("el-select",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],attrs:{size:"small","default-first-option":"","allow-create":"",filterable:"",multiple:""},model:{value:e.handledDialogPortifolios,callback:function(i){e.handledDialogPortifolios=i},expression:"handledDialogPortifolios"}},e._l(e.portifolios,(function(e){return i("el-option",{key:`portifolio-${e.id}`,attrs:{value:e.id,label:e.name}})})),1),i("span",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(i){return e.closeDialog()}}},[e._v("Cancelar")]),i("el-button",{attrs:{type:"primary",disabled:e.disableSavePortifolios},on:{click:e.salvarPortifolios}},[e._v(" Salvar ")])],1)],1)],1)},a=[],n=t(90408),s=t(51579),l=t.n(s),r={props:{filterTerm:{type:String,default:()=>""},hideSearch:{type:Boolean,default:!1}},data:()=>({isLoading:!1,modelSearch:"",dialog:{visible:!1,workspace:null,portifolios:[]},workspaces:[],activeRow:null,debounce:null,inviteForm:{email:"",profile:""}}),computed:{...(0,n.Se)({keyAccounts:"getWorkspaceKeyAccounts",portifolios:"getPortifolios",portifoliosByWorkspace:"getPortifoliosByWorkspace"}),search:{get(){return this.modelSearch||this.filterTerm},set(e){clearTimeout(this.debounce),this.debounce=setTimeout((()=>{this.modelSearch=e}),250)}},portifolioById(){return e=>this.portifolios.find((i=>Number(i.id)===Number(e)))},filteredWorkspaces(){return this.search?this.workspaces.filter((({name:e,teamName:i,keyAccountId:t})=>{const o=this.search.toLocaleLowerCase(),a=(i||"").toLocaleLowerCase(),n=(this.keyAccountTemplate(this.findKeyAccount(t))||"").toLocaleLowerCase(),s=(e||"").toLocaleLowerCase();return a.includes(o)||s.includes(o)||n.includes(o)})).map((e=>({portifolios:[],...e}))):this.workspaces.map((e=>({portifolios:[],...e})))},handledDialogPortifolios:{get(){return this.portifoliosByWorkspace[this.dialog.workspace]||[]},set(e){const i=e.filter((e=>"string"!==typeof e||(this.createPortifolioAndInsert({name:e,workspaceId:this.dialog.workspace}).finally((()=>this.$forceUpdate())),!1)));this.insertPortifolios({portifolios:i,workspaceId:this.dialog.workspace})}},disableSavePortifolios(){return l().isEqual(this.handledDialogPortifolios,this.dialog.portifolios)}},beforeMount(){this.init()},methods:{...(0,n.nv)(["myWorkspace","editWorkpace","getPortifolios","adminWorkspaces","adminWorkspaceUsers","getPortifolioAssociated","getWorkspaceKeyAccounts","setPortifolioToWorkspace","updateWorkspaceKeyAccount","createPortifolioAndInsert","associatePortifolioToWorkspace","disassociatePortifolioToWorkspace"]),...(0,n.OI)(["insertPortifolios"]),init(){this.isLoading=!0,this.adminWorkspaces({params:{size:99999},headers:{Workspace:null}}).then((({content:e})=>{this.$set(this,"workspaces",[]),this.workspaces=e})).finally((()=>{this.$nextTick().then((()=>{this.isLoading=!1}))}))},findKeyAccount(e){return(this.keyAccounts||[]).find((({id:i})=>Number(i)===Number(e)))},keyAccountTemplate(e){return e?(e.name?`${e.name} - `:"")+`${e.email}`:"-"},updateWorkspacePortifolios(e,i){this.$set(this.workspaces.find((({id:i})=>Number(i)===Number(e))),"portifolios",i)},openPortifolioDialog(e){this.isLoading=!0,this.getPortifolioAssociated(e).then((i=>{this.updateWorkspacePortifolios(e,i),this.dialog={portifolios:i.map((({id:e})=>Number(e))),visible:!0,workspace:e},this.handledDialogPortifolios=i.map((({id:e})=>Number(e)))})).finally((()=>{this.isLoading=!1}))},salvarPortifolios(){const e=l().difference(this.handledDialogPortifolios,this.dialog.portifolios),i=l().difference(this.dialog.portifolios,this.handledDialogPortifolios),t=this.dialog.workspace;this.isLoading=!0,Promise.all([...i.map((e=>this.disassociatePortifolioToWorkspace({portifolioId:e,workspaceId:t}))),...e.map((e=>this.associatePortifolioToWorkspace({portifolioId:e,workspaceId:t})))]).then((()=>{this.updateWorkspacePortifolios(t,this.handledDialogPortifolios.map((e=>({id:e})))),this.$jusNotification({type:"success",title:"Yay!",message:"Tipos de carteira salvos com sucesso"}),this.closeDialog()})).finally((()=>{this.isLoading=!1}))},closeDialog(){this.dialog={portifolios:[],visible:!1,workspace:null}},handleRowClick(e,i,t){switch(i.property){case"portifolios":this.openPortifolioDialog(e.id);break;case"keyAccountId":this.setActiveRow(e.id);break;default:break}},setActiveRow(e){this.activeRow=e,this.$nextTick((()=>{document.querySelector(`#ka-select-${e}`)&&document.querySelector(`#ka-select-${e}`).click()}))},saveKeyAccountInToWorkspace(e,{id:i}){this.updateWorkspaceKeyAccount({keyAccountId:e,workspaceId:i}).then((()=>{this.setActiveRow(null)}))},handleEditWorkspace(e){document.querySelector(".admin-panel-view__panel-header").click(),this.isLoading=!0,this.adminWorkspaces({method:"put",data:e}).then((()=>{this.$jusNotification({title:"Yay!",message:"Alteração salva com sucesso!",type:"success"})})).catch((e=>{this.$jusNotification({error:e})})).finally(this.init)},handleArchiveWorkspace(e,i){this.$confirm(`Deseja realmente <strong>${e?"reativar":"desativar"}</strong> a workspace <strong>${i.name}</strong>?`,"Atenção",{dangerouslyUseHTMLString:!0,confirmButtonText:"Confirmar",cancelButtonText:"Cancelar",closeOnPressEscape:!1,closeOnClickModal:!1,center:!0}).then((()=>{this.adminWorkspaces({method:"put",data:{...i,status:{true:"READY",false:"DISABLED"}[e]}}).then((()=>this.$jusNotification({title:"Yay!",message:"Ação executada com sucesso.",type:"success"}))).catch((e=>this.$jusNotification({error:e}))).finally(this.init)}))},handleInviteEmail({subDomain:e}){this.adminWorkspaceUsers({method:"post",url:`api/accounts/workspaces/invite-teammates/${e}`,data:[{...this.inviteForm}],headers:{Workspace:e}}).then((()=>this.$jusNotification({title:"Yay!",message:"Convite enviado.",type:"success"}))).catch((e=>this.$jusNotification({error:e}))).finally((()=>{document.querySelector(".admin-panel-view__panel-header").click()}))}}},c=r,p=(t(15598),t(22381),t(1001)),d=(0,p.Z)(c,o,a,!1,null,"12b806df",null),u=d.exports},52040:function(e,i,t){"use strict";t.r(i);var o=t(87537),a=t.n(o),n=t(23645),s=t.n(n),l=s()(a());l.push([e.id,".portifolios-dialog .el-dialog__body .el-select{width:100%}.portifolios-column{padding:4px 0!important}.portifolios-column .cell .el-tag{margin:4px}.portifolios-column .cell .portifolios-column__container{display:flex;justify-content:flex-end;align-items:center;gap:16px}.workspace-container .el-table__row .el-table__cell .cell .el-select{background-color:transparent}.workspace-container .el-table__row .el-table__cell .cell .el-select .el-input{overflow:hidden;background-color:transparent}.workspace-container .el-table__row .el-table__cell .cell .el-select .el-input .el-input__inner{border:none;text-align:left;padding-left:0;background-color:transparent}.workspace-container .el-table__row .el-table__cell .cell .el-select .el-input .el-input__suffix{visibility:hidden}.workspace-container .el-table__row .el-table__cell .cell .el-icon-edit{display:none;cursor:pointer}.workspace-container .el-table__row .el-table__cell .cell:hover .el-icon-edit{display:inline}.workspace-container .el-table__row .el-table__cell .cell:hover .el-select .el-input .el-input__suffix{visibility:visible}.worspace-name__edit .el-popover__title{text-align:center}.worspace-name__edit article{display:flex;flex-direction:column;gap:8px;width:20vw}.worspace-name__edit article .actions{display:flex;gap:8px}.worspace-name__edit article .actions .el-button{flex:1;margin:0}","",{version:3,sources:["webpack://./src/views/adminPanel/partials/WorkspaceList.vue"],names:[],mappings:"AAGI,gDACE,UAAA,CAKN,oBACE,uBAAA,CAGE,kCACE,UAAA,CAGF,yDACE,YAAA,CACA,wBAAA,CACA,kBAAA,CACA,QAAA,CASE,qEACE,4BAAA,CAEA,+EACE,eAAA,CACA,4BAAA,CAEA,gGACE,WAAA,CACA,eAAA,CACA,cAAA,CACA,4BAAA,CAGF,iGACE,iBAAA,CAKN,wEACE,YAAA,CACA,cAAA,CAIA,8EACE,cAAA,CAKE,uGACE,kBAAA,CAWd,wCACE,iBAAA,CAGF,6BACE,YAAA,CACA,qBAAA,CACA,OAAA,CACA,UAAA,CAEA,sCACE,YAAA,CACA,OAAA,CAEA,iDACE,MAAA,CACA,QAAA",sourcesContent:["\n.portifolios-dialog {\n  .el-dialog__body {\n    .el-select {\n      width: 100%;\n    }\n  }\n}\n\n.portifolios-column {\n  padding: 4px 0 !important;\n\n  .cell {\n    .el-tag {\n      margin: 4px;\n    }\n\n    .portifolios-column__container {\n      display: flex;\n      justify-content: flex-end;\n      align-items: center;\n      gap: 16px;\n    }\n  }\n}\n\n.workspace-container {\n  .el-table__row {\n    .el-table__cell {\n      .cell {\n        .el-select {\n          background-color: transparent;\n\n          .el-input {\n            overflow: hidden;\n            background-color: transparent;\n\n            .el-input__inner {\n              border: none;\n              text-align: left;\n              padding-left: 0;\n              background-color: transparent;\n            }\n\n            .el-input__suffix {\n              visibility: hidden;\n            }\n          }\n        }\n\n        .el-icon-edit {\n          display: none;\n          cursor: pointer;\n        }\n\n        &:hover {\n          .el-icon-edit {\n            display: inline;\n          }\n\n          .el-select {\n            .el-input {\n              .el-input__suffix {\n                visibility: visible;\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n\n.worspace-name__edit {\n  .el-popover__title {\n    text-align: center;\n  }\n\n  article {\n    display: flex;\n    flex-direction: column;\n    gap: 8px;\n    width: 20vw;\n\n    .actions {\n      display: flex;\n      gap: 8px;\n\n      .el-button {\n        flex: 1;\n        margin: 0;\n      }\n    }\n  }\n}\n"],sourceRoot:""}]),i["default"]=l},46070:function(e,i,t){"use strict";t.r(i);var o=t(87537),a=t.n(o),n=t(23645),s=t.n(n),l=s()(a());l.push([e.id,".workspace-container[data-v-12b806df]{width:100%}","",{version:3,sources:["webpack://./src/views/adminPanel/partials/WorkspaceList.vue"],names:[],mappings:"AACA,sCACE,UAAA",sourcesContent:["\n.workspace-container {\n  width: 100%;\n}\n"],sourceRoot:""}]),i["default"]=l},15598:function(e,i,t){var o=t(52040);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var a=t(39185).Z;a("17a0576e",o,!0,{sourceMap:!0,shadowMode:!1})},22381:function(e,i,t){var o=t(46070);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var a=t(39185).Z;a("c4ae238c",o,!0,{sourceMap:!0,shadowMode:!1})}}]);
//# sourceMappingURL=5611.js.map