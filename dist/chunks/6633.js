(self["webpackChunk_projuris_justto_web"]=self["webpackChunk_projuris_justto_web"]||[]).push([[6633],{66633:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return p}});var s=function(){var e=this,t=e._self._c;return e.visible?t("el-dialog",{attrs:{visible:e.visible,"show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,title:`Quer notificar ${e.name?e.$options.filters.resumedName(e.name):e.emailmonimo} desta ação?`,"append-to-body":"","destroy-on-close":"",width:"604px","custom-class":"dialog-actions__increase-alert"},on:{"update:visible":function(t){e.visible=t}}},[t("article",{staticClass:"dialog-actions__increase-alert-body jus-ckeditor__parent"},[t("label",{staticClass:"dialog-actions__increase-alert-body-label"},[t("div",{staticClass:"dialog-actions__increase-alert-body-label-text"},[e._v(" Mensagem que será enviada: ")])]),e.visible?t("ckeditor",{ref:"messageEditor",attrs:{editor:e.editor,config:e.editorConfig,type:"classic"},model:{value:e.message,callback:function(t){e.message=t},expression:"message"}}):e._e()],1),t("div",{staticClass:"dialog-actions__increase-alert-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-tooltip",{attrs:{content:"Não notificará desta vez, porém perguntará se deve notificar na próxima.",placement:"top"}},[t("el-button",{attrs:{size:"small",type:"default"},on:{click:function(t){return e.handleCompanyAnalysisAction("NEVER")}}},[e._v(" Não notificar ")])],1),t("el-tooltip",{attrs:{content:"Notificará desta vez, e todas as próximas.",placement:"top"}},[t("el-button",{attrs:{size:"small",type:"secondary"},on:{click:function(t){return e.handleCompanyAnalysisAction("ALWAYS")}}},[e._v(" Sempre notificar ")])],1),t("el-tooltip",{attrs:{content:"Notificará desta vez e perguntará se deve notificar na próxima.",placement:"top"}},[t("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.handleCompanyAnalysisAction("ASK")}}},[e._v(" Notificar somente dessa vez ")])],1)],1)]):e._e()},a=[],n=i(90408),o=i(89985);const r={DISFAVOR:4500,FAVORITE:4494},l={DISFAVOR:"FAVORITE_NOTIFICATION",FAVORITE:"FAVORITE_NOTIFICATION"};var c={mixins:[o.Z],data:()=>({disputeId:null,visible:!1,message:"",action:"",email:"",name:""}),computed:{...(0,n.Se)({userPreferences:"userPreferences"})},methods:{...(0,n.nv)(["getAccountProperty","setAccountProperty","getQuickReplyTemplates","sendemail"]),async open(e,t){if(t.getDisputeHasLastReceivedMessageProperties){{const{PERSON_EMAIL:e,PERSON_NAME:i}=t.lastReceivedMessage?.properties;if(!t?.getDisputeLastReceivedMessageProperties?.PERSON_EMAIL)return void this.close();this.email=e,this.name=i||""}this.disputeId=Number(this.$route.params.id),await this.getQuickReplyTemplates(this.$route.params.id).then((t=>{t.forEach((({parsed:{body:t,referenceTemplateId:i}})=>{i===r[e]&&(this.message=t)}))})),this.message?(this.action=e,this.getAccountProperty(l[this.action]).then(((e={})=>{"ALWAYS"===e[l[this.action]]?this.sendMessage():this.visible=!0}))):this.close()}else this.close()},close(){this.disputeId=null,this.visible=!1,this.message="",this.action="",this.email="",this.name=""},handleCompanyAnalysisAction(e){const{action:t}=this,i={};switch(e){case"ALWAYS":this.sendMessage(),i[l[t]]="ALWAYS";break;default:i[l[t]]="","ASK"===e&&this.sendMessage();break}this.setAccountProperty(i),this.close()},sendMessage(){const e={to:[{address:this.email}],disputeId:this.disputeId,attachments:[],message:this.message,externalIdentification:null,inReplyTo:null};this.sendemail(e).then((()=>{this.$jusNotification({type:"success",title:"Yay!",message:"Notificação enviada com sucesso"})})).catch((e=>{this.$jusNotification({error:e})})).finally(this.close)},editMessage(){}}},d=c,u=(i(74275),i(1001)),m=(0,u.Z)(d,s,a,!1,null,null,null),p=m.exports},89985:function(e,t,i){"use strict";i.d(t,{Z:function(){return x}});var s=i(61927),a=i(53083),n=i(82311),o=i(30418),r=i(16726),l=i(84687),c=i(75304),d=i(4434),u=i(93124),m=i(86537),p=i(98009),h=i(24697),g=i(28927),b=i(13264),f=i(95994),v=i(31789),A=i(92619),y=i(70756),_=i(97525),w=i(4424),I=i(35898),k=i(57759),C=i(97865),M=i(37259),Z=i(40917);class T extends k.Z{constructor(e){super(e),this.editor=e,this.buttonView=null,this.createButton(),this.editor.ui.componentFactory.add("preview",(()=>this.buttonView))}createButton(){const e='<svg xmlns="http://www.w3.org/2000/svg" width="18.409" height="18"><path data-name="Retângulo 67" fill="none" d="M.204 0h18v18h-18z"/><g data-name="Grupo 3101"><g data-name="Grupo 26"><path data-name="Caminho 253" d="M9.205 12.018a3.043 3.043 0 10-3.019-3.043 3.031 3.031 0 003.019 3.043z" fill="none" stroke="#000" stroke-width=".8"/><path data-name="Caminho 254" d="M9.204 10.745a1.839 1.839 0 10-1.781-1.838 1.814 1.814 0 001.781 1.838z" fill="#191919" fill-rule="evenodd"/><path data-name="Caminho 11629" d="M9.761 9.397a1.032 1.032 0 10-1-1.032 1.019 1.019 0 001 1.032z" fill="#fff" fill-rule="evenodd"/><path data-name="Caminho 255" d="M17.909 8.902a10.174 10.174 0 00-17.409 0 10.174 10.174 0 0017.409 0z" fill="none" stroke="#000" stroke-linecap="round" stroke-linejoin="round"/></g></g></svg>';this.buttonView=new C.Z,this.buttonView.set({label:"Visualizar Mensagem",icon:e,tooltip:!0}),this.buttonView.on("execute",(()=>{const e=Array(...document.querySelectorAll(".ck-content")).pop();if(e){const{getSelectedIds:t}=M["default"].getters,i=t.length?t[0]:Number(location.href.split("/").pop()),s=e.innerHTML;Z.YB.$emit("SEE-PREVIEW",{template:s,disputeId:i})}}))}}class V extends k.Z{constructor(e){super(e),this.editor=e,this.buttonView=null,this.createButton(),this.editor.ui.componentFactory.add("imageAttachment",(()=>this.buttonView))}createButton(){const e='<svg xmlns="http://www.w3.org/2000/svg" width="18" style="margin-left: 10px !important;" height="18"><path data-name="Caminho 13974" d="M8.948 4.948a.611.611 0 10-1.222 0c0 .009.005.017.005.026V13.5a3.254 3.254 0 11-6.508 0V3.273a2.034 2.034 0 114.067 0v8.591a.813.813 0 11-1.626 0V4.942a.106.106 0 000-.017.611.611 0 10-1.222 0 .106.106 0 000 .017v6.922a2.034 2.034 0 104.068 0V3.273a3.254 3.254 0 11-6.508 0V13.5a4.474 4.474 0 108.948 0V4.974h-.005c-.002-.009.003-.017.003-.026z"/></svg>';this.buttonView=new C.Z,this.buttonView.set({label:"Inserir Imagem",icon:e,tooltip:!0,withText:!1}),this.buttonView.on("execute",(()=>M["default"].dispatch("toggleImageUploadDialog",!0)))}}class E extends k.Z{constructor(e){super(e),this.editor=e,this.registerConverters()}registerConverters(){this.editor.conversion.for("upcast").elementToAttribute({view:{name:"",key:"data-mention",classes:"",attributes:{href:!0,"data-user-id":!0}},model:{key:"mention",value:e=>{const t=this.editor.plugins.get("Mention").toMentionAttribute(e,{link:e.getAttribute("href"),userId:e.getAttribute("data-user-id")});return t}},converterPriority:"high"}),this.editor.conversion.for("downcast").attributeToElement({model:"mention",view:(e,{writer:t})=>{if(!e)return;const i="image"===e.type,s="memberMention"===e.type;return t.createAttributeElement(i?"img":s?"em":"span",{class:"justto-variable","data-mention":e.id,src:e.id,...s?{class:"justto-mention","account-id":e.accountId}:{}},{priority:20,id:e.uid})},converterPriority:"high"})}}var R=i(90408),x={data(){return{editor:s.Z}},computed:{...(0,R.Se)({variables:"getAvaliableVariablesToTemplate",members:"workspaceMembersByDispute"}),editorConfig(){return{plugins:[a.Z,n.Z,o.Z,r.Z,h.Z,g.Z,b.Z,l.Z,c.Z,d.Z,u.Z,m.Z,p.Z,f.Z,v.Z,A.Z,y.Z,...this.dontUseTablePlugin?[]:[w.Z,I.Z],...this.useImageAttachmentPlugin?[V]:[],...this.useMentionPlugin?[_.Z,E]:[],...this.usePreviewPlugin?[T]:[]],mention:this.useMentionPlugin?{feeds:[{marker:"{",feed:this.getFeedItems,minimumCharacters:1,itemRenderer:this.customItemRenderer},{marker:"@",feed:this.getFeedPersonItems,minimumCharacters:0,itemRenderer:this.customMemberItemRenderer}]}:{},toolbar:{items:["bold","italic","underline","removeFormat","link","bulletedList","numberedList","|","insertTable","|","outdent","indent","|","blockQuote","undo","redo","imageStyle",...this.useImageAttachmentPlugin?["imageAttachment"]:[],...this.usePreviewPlugin?["preview"]:[]],viewportTopOffset:30,shouldNotGroupWhenFull:!0},table:{contentToolbar:["tableColumn","tableRow","mergeTableCells"]}}},variablesList(){const e=[],t=[];return Object.keys(this.variables).map((i=>({id:`{{${i}}}`,name:`${this.variables[i]}`,type:e.includes(i)?"img":t.includes(i)?"link":"text"})))}},beforeMount(){this.getAvaliableVariablesToTemplate()},methods:{...(0,R.nv)(["getAvaliableVariablesToTemplate"]),setImgTag(e){this.$nextTick((()=>{const t=document.querySelector(".ck-editor__editable").ckeditorInstance;t.model.change((i=>{const s=i.createElement("image",{src:e});t.model.insertContent(s,t.model.document.selection)}))}))},customItemRenderer(e){return e.name},customMemberItemRenderer(e){return e.person?.name||e.accountEmail},getFeedItems(e){function t({name:t,id:i}){const s=(0,Z.Ue)(e).replace(/{/g,"");return(0,Z.Ue)(t).includes(s)||(0,Z.Ue)(i).includes(s)}return this.variablesList.filter(t)},getFeedPersonItems(e){function t({name:t,person:i}){const s=(0,Z.Ue)(e).replace(/{/g,"");return i?(0,Z.Ue)(i.name).includes(s):(0,Z.Ue)(t).includes(s)}return this.members.filter(t).map((e=>({...e,type:"memberMention",id:`@${this.customMemberItemRenderer(e)}`})))},ckeditorFocus(e){}}}},98876:function(e,t,i){"use strict";i.r(t);var s=i(87537),a=i.n(s),n=i(23645),o=i.n(n),r=o()(a());r.push([e.id,".dialog-actions__increase-alert .el-dialog__body{margin-top:0!important}.dialog-actions__increase-alert .el-dialog__body .dialog-actions__increase-alert-body .dialog-actions__increase-alert-body-label{display:block;font-weight:600;margin-bottom:16px}.dialog-actions__increase-alert .el-dialog__body .dialog-actions__increase-alert-body .dialog-actions__increase-alert-body-text{word-break:keep-all}","",{version:3,sources:["webpack://./src/components/dialogs/NotifyOnCompanyAnalysis.vue"],names:[],mappings:"AAIE,iDACE,sBAAA,CAGE,iIACE,aAAA,CACA,eAAA,CACA,kBAAA,CAGF,gIACE,mBAAA",sourcesContent:["\n@import '~projuris-acordos-theme/src/common/colors.scss';\n\n.dialog-actions__increase-alert {\n  .el-dialog__body {\n    margin-top: 0 !important;\n\n    .dialog-actions__increase-alert-body {\n      .dialog-actions__increase-alert-body-label {\n        display: block;\n        font-weight: 600;\n        margin-bottom: 16px;\n      }\n\n      .dialog-actions__increase-alert-body-text {\n        word-break: keep-all;\n      }\n    }\n  }\n}\n"],sourceRoot:""}]),t["default"]=r},74275:function(e,t,i){var s=i(98876);s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals);var a=i(39185).Z;a("346bcd77",s,!0,{sourceMap:!0,shadowMode:!1})}}]);
//# sourceMappingURL=6633.js.map