(self["webpackChunk_projuris_justto_web"]=self["webpackChunk_projuris_justto_web"]||[]).push([[7233],{7233:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return d}});var i=function(){var t=this,e=t._self._c;return t.visible?e("el-form",{staticClass:"discounts__form",attrs:{model:t.form,size:"mini"}},[e("el-row",{staticClass:"mb10"},[e("el-col",{attrs:{span:24}},[e("h3",{staticClass:"mb0 mt0"},[t._v(" Descontos por importação ")])])],1),e("el-row",{attrs:{gutter:8}},[t._l(t.form.discounts,(function(n,i){return e("el-col",{key:`discount#${i}`,attrs:{span:24}},[e("SingleDiscountForm",{on:{delete:function(e){return t.handleRemoveDiscount(i)}},model:{value:t.form.discounts[i],callback:function(e){t.$set(t.form.discounts,i,e)},expression:"form.discounts[dIndex]"}})],1)})),e("el-col",{attrs:{span:24}},[e("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},on:{click:t.handleAddDiscount}},[t._v(" Adicionar desconto ")])],1)],2),e("el-row",[e("el-col",[e("el-form-item",{staticClass:"flex-end"},[e("el-button",{on:{click:t.handleCancel}},[t._v(" Cancelar ")]),e("el-button",{attrs:{type:"primary",disabled:t.loading},on:{click:t.handleSave}},[e("i",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticClass:"el-icon-loading"}),t._v(" Salvar ")])],1)],1)],1)],1):e("DiscountsDescription",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{discounts:t.discounts},on:{click:t.handleenableEdit}})},o=[],l=(n(57658),n(90408)),s={name:"EditDiscountsForm",components:{DiscountsDescription:()=>n.e(437).then(n.bind(n,30437)),SingleDiscountForm:()=>n.e(1296).then(n.bind(n,41296))},props:{contract:{type:Object,required:!0},customer:{type:Object,required:!0}},data:()=>({loading:!1,visible:!1,form:{discounts:[]}}),computed:{...(0,l.Se)({discountsById:"contractDiscountList"}),discounts(){return this.discountsById[this.contract?.id]||[]}},mounted(){this.init()},methods:{...(0,l.nv)(["addContractDiscount","changeContractDiscount","deleteContractDiscount","getContractDiscountList"]),handleUpdateDiscountsList(){this.form.discounts=[...this.discountsById[this.contract?.id]]},handleShowLoading(){this.loading=!0},init(){this.contract?.id&&(this.handleShowLoading(),this.getContractDiscountList(this.contract?.id).then((t=>{this.handleUpdateDiscountsList(),0===this.form.discounts.length&&this.handleAddDiscount()})).catch((t=>this.$jusNotification({error:t}))).finally((()=>{this.loading=!1})))},handleCancel(){this.loading=!1,this.visible=!1},handleSave(){this.handleShowLoading();const t=this.form.discounts.map((t=>({fn:t?.id?this.changeContractDiscount:this.addContractDiscount,payload:{contractId:this.contract.id,discountId:t?.id,discount:t}})));Promise.all(t.map((({fn:t,payload:e})=>t(e)))).then((async t=>{this.$jusNotification({type:"success",title:"Yay!",message:"Contrato editado com sucesso."}),this.handleUpdateDiscountsList(),this.handleCancel()})).catch((t=>{this.$jusNotification({error:t})})).finally((()=>{this.loading=!1}))},handleAddDiscount(){this.form.discounts.push({minVolume:0,value:0,type:"MONTHLY_SUBSCRIPTION_VALUE"})},handleRemoveDiscount(t){console.log("handleRemoveDiscount",t),this.form.discounts[t]?.id&&(this.handleShowLoading(),this.deleteContractDiscount({contractId:this.contract.id,discountId:this.form.discounts[t]?.id}).catch((t=>this.$jusNotification({error:t}))).finally((()=>{this.loading=!1}))),this.form.discounts.splice(t,1)},async handleenableEdit(){await this.init(),this.visible=!0}}},r=s,c=(n(65439),n(1001)),a=(0,c.Z)(r,i,o,!1,null,null,null),d=a.exports},90330:function(t,e,n){"use strict";n.r(e);var i=n(87537),o=n.n(i),l=n(23645),s=n.n(l),r=s()(o());r.push([t.id,".discounts__form .el-row .el-col .el-form-item.flex-item{display:flex;flex-direction:column;align-items:flex-start}.discounts__form .el-row .el-col .el-form-item.flex-item .el-form-item__content{width:100%}.discounts__form .el-row .el-col .el-form-item.flex-item .el-form-item__content .el-form--inline .el-row .el-col .el-form-item{width:100%!important}.discounts__form .el-row .el-col .el-form-item.flex-item .el-form-item__content .el-form--inline .el-row .el-col .el-form-item .el-form-item__label{font-weight:400!important}.discounts__form .el-row .el-col .el-form-item.flex-item .el-form-item__content .el-form--inline .el-row .el-col .el-form-item .el-form-item__content .el-input-number{width:100%!important}.discounts__form .el-row .el-col .el-form-item.flex-item .el-form-item__content .el-form--inline .el-row .el-col .labelless .el-form-item__label{visibility:hidden}.discounts__form .el-row .el-col .el-form-item.flex-item.small-label .el-form-item__label{font-size:1rem!important}.discounts__form .el-row .el-col .el-form-item.flex-end{margin:0}.discounts__form .el-row .el-col .el-form-item.flex-end .el-form-item__content{display:flex;justify-content:flex-end}","",{version:3,sources:["webpack://./src/views/main/billing/partials/partials/EditDiscountsForm.vue"],names:[],mappings:"AAIM,yDACE,YAAA,CACA,qBAAA,CACA,sBAAA,CAEA,gFACE,UAAA,CAKM,+HACE,oBAAA,CAEA,oJACE,yBAAA,CAIA,uKACE,oBAAA,CAMJ,iJACE,iBAAA,CASV,0FACE,wBAAA,CAKN,wDACE,QAAA,CAEA,+EACE,YAAA,CACA,wBAAA",sourcesContent:["\n.discounts__form {\n  .el-row {\n    .el-col {\n      .el-form-item.flex-item {\n        display: flex;\n        flex-direction: column;\n        align-items: flex-start;\n\n        .el-form-item__content {\n          width: 100%;\n\n          .el-form--inline {\n            .el-row {\n              .el-col {\n                .el-form-item {\n                  width: 100% !important;\n\n                  .el-form-item__label {\n                    font-weight: normal !important;\n                  }\n\n                  .el-form-item__content {\n                    .el-input-number {\n                      width: 100% !important;\n                    }\n                  }\n                }\n\n                .labelless {\n                  .el-form-item__label  {\n                    visibility: hidden;\n                  }\n                }\n              }\n            }\n          }\n        }\n\n        &.small-label {\n          .el-form-item__label {\n            font-size: 1rem !important;\n          }\n        }\n      }\n\n      .el-form-item.flex-end {\n        margin: 0;\n\n        .el-form-item__content {\n          display: flex;\n          justify-content: flex-end;\n        }\n      }\n    }\n  }\n}\n"],sourceRoot:""}]),e["default"]=r},65439:function(t,e,n){var i=n(90330);i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);var o=n(39185).Z;o("6c7faca4",i,!0,{sourceMap:!0,shadowMode:!1})}}]);
//# sourceMappingURL=7233.js.map