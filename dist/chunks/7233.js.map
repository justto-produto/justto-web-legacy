{"version":3,"file":"chunks/7233.js","mappings":"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","sources":["webpack://@projuris/justto-web/./src/views/main/billing/partials/partials/EditDiscountsForm.vue","webpack://@projuris/justto-web/src/views/main/billing/partials/partials/EditDiscountsForm.vue","webpack://@projuris/justto-web/./src/views/main/billing/partials/partials/EditDiscountsForm.vue?0c30","webpack://@projuris/justto-web/./src/views/main/billing/partials/partials/EditDiscountsForm.vue?d5a1","webpack://@projuris/justto-web/./src/views/main/billing/partials/partials/EditDiscountsForm.vue?d0b5","webpack://@projuris/justto-web/./src/views/main/billing/partials/partials/EditDiscountsForm.vue?c45e"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return (_vm.visible)?_c('el-form',{staticClass:\"discounts__form\",attrs:{\"model\":_vm.form,\"size\":\"mini\"}},[_c('el-row',{staticClass:\"mb10\"},[_c('el-col',{attrs:{\"span\":24}},[_c('h3',{staticClass:\"mb0 mt0\"},[_vm._v(\" Descontos por importação \")])])],1),_c('el-row',{attrs:{\"gutter\":8}},[_vm._l((_vm.form.discounts),function(discount,dIndex){return _c('el-col',{key:`discount#${dIndex}`,attrs:{\"span\":24}},[_c('SingleDiscountForm',{on:{\"delete\":function($event){return _vm.handleRemoveDiscount(dIndex)}},model:{value:(_vm.form.discounts[dIndex]),callback:function ($$v) {_vm.$set(_vm.form.discounts, dIndex, $$v)},expression:\"form.discounts[dIndex]\"}})],1)}),_c('el-col',{attrs:{\"span\":24}},[_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"mini\",\"icon\":\"el-icon-plus\"},on:{\"click\":_vm.handleAddDiscount}},[_vm._v(\" Adicionar desconto \")])],1)],2),_c('el-row',[_c('el-col',[_c('el-form-item',{staticClass:\"flex-end\"},[_c('el-button',{on:{\"click\":_vm.handleCancel}},[_vm._v(\" Cancelar \")]),_c('el-button',{attrs:{\"type\":\"primary\",\"disabled\":_vm.loading},on:{\"click\":_vm.handleSave}},[_c('i',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.loading),expression:\"loading\"}],staticClass:\"el-icon-loading\"}),_vm._v(\" Salvar \")])],1)],1)],1)],1):_c('DiscountsDescription',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],attrs:{\"discounts\":_vm.discounts},on:{\"click\":_vm.handleenableEdit}})\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <el-form\n    v-if=\"visible\"\n    :model=\"form\"\n    size=\"mini\"\n    class=\"discounts__form\"\n  >\n    <el-row class=\"mb10\">\n      <el-col :span=\"24\">\n        <h3 class=\"mb0 mt0\">\n          Descontos por importação\n        </h3>\n      </el-col>\n    </el-row>\n\n    <el-row :gutter=\"8\">\n      <el-col\n        v-for=\"(discount, dIndex) in form.discounts\"\n        :key=\"`discount#${dIndex}`\"\n        :span=\"24\"\n      >\n        <SingleDiscountForm\n          v-model=\"form.discounts[dIndex]\"\n          @delete=\"handleRemoveDiscount(dIndex)\"\n        />\n      </el-col>\n\n      <el-col :span=\"24\">\n        <el-button\n          type=\"primary\"\n          size=\"mini\"\n          icon=\"el-icon-plus\"\n          @click=\"handleAddDiscount\"\n        >\n          Adicionar desconto\n        </el-button>\n      </el-col>\n    </el-row>\n\n    <el-row>\n      <el-col>\n        <el-form-item class=\"flex-end\">\n          <el-button @click=\"handleCancel\">\n            Cancelar\n          </el-button>\n\n          <el-button\n            type=\"primary\"\n            :disabled=\"loading\"\n            @click=\"handleSave\"\n          >\n            <i\n              v-show=\"loading\"\n              class=\"el-icon-loading\"\n            />\n\n            Salvar\n          </el-button>\n        </el-form-item>\n      </el-col>\n    </el-row>\n  </el-form>\n\n  <DiscountsDescription\n    v-else\n    v-loading=\"loading\"\n    :discounts=\"discounts\"\n    @click=\"handleenableEdit\"\n  />\n</template>\n\n<script>\nimport { mapActions, mapGetters } from 'vuex'\n\nexport default {\n  name: 'EditDiscountsForm',\n\n  components: {\n    DiscountsDescription: () => import('./partials/DiscountsDescription.vue'),\n    SingleDiscountForm: () => import('./partials/SingleDiscountForm')\n  },\n\n  props: {\n    contract: {\n      type: Object,\n      required: true\n    },\n\n    customer: {\n      type: Object,\n      required: true\n    }\n  },\n\n  data: () => ({\n    loading: false,\n    visible: false,\n    form: {\n      discounts: []\n    }\n  }),\n\n  computed: {\n    ...mapGetters({\n      discountsById: 'contractDiscountList'\n    }),\n\n    discounts() {\n      return this.discountsById[this.contract?.id] || []\n    }\n  },\n\n  mounted() {\n    this.init()\n  },\n\n  methods: {\n    ...mapActions([\n      'addContractDiscount',\n      'changeContractDiscount',\n      'deleteContractDiscount',\n      'getContractDiscountList'\n    ]),\n\n    handleUpdateDiscountsList() {\n      this.form.discounts = [...this.discountsById[this.contract?.id]]\n    },\n\n    handleShowLoading() {\n      this.loading = true\n    },\n\n    init() {\n      if (!this.contract?.id) return\n\n      this.handleShowLoading()\n\n      this.getContractDiscountList(this.contract?.id).then(_ => {\n        this.handleUpdateDiscountsList()\n\n        if (this.form.discounts.length === 0) this.handleAddDiscount()\n      }).catch(error => this.$jusNotification({ error })).finally(() => { this.loading = false })\n    },\n\n    handleCancel() {\n      this.loading = false\n      this.visible = false\n    },\n\n    handleSave() {\n      this.handleShowLoading()\n\n      const promises = this.form.discounts.map(discount => ({\n        fn: discount?.id ? this.changeContractDiscount : this.addContractDiscount,\n        payload: { contractId: this.contract.id, discountId: discount?.id, discount }\n      }))\n\n      Promise.all(promises.map(({ fn, payload }) => fn(payload))).then(async _ => {\n        this.$jusNotification({\n          type: 'success',\n          title: 'Yay!',\n          message: 'Contrato editado com sucesso.'\n        })\n\n        this.handleUpdateDiscountsList()\n        this.handleCancel()\n      }).catch(error => {\n        this.$jusNotification({ error })\n      }).finally(() => {\n        this.loading = false\n      })\n    },\n\n    handleAddDiscount() {\n      this.form.discounts.push({\n        minVolume: 0,\n        value: 0,\n        type: 'MONTHLY_SUBSCRIPTION_VALUE'\n      })\n    },\n\n    handleRemoveDiscount(index) {\n      console.log('handleRemoveDiscount', index)\n\n      if (this.form.discounts[index]?.id) {\n        this.handleShowLoading()\n\n        this.deleteContractDiscount({\n          contractId: this.contract.id,\n          discountId: this.form.discounts[index]?.id\n        })\n          .catch(error => this.$jusNotification({ error }))\n          .finally(() => { this.loading = false })\n      }\n\n      this.form.discounts.splice(index, 1)\n    },\n\n    async handleenableEdit() {\n      await this.init()\n\n      this.visible = true\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n.discounts__form {\n  .el-row {\n    .el-col {\n      .el-form-item.flex-item {\n        display: flex;\n        flex-direction: column;\n        align-items: flex-start;\n\n        .el-form-item__content {\n          width: 100%;\n\n          .el-form--inline {\n            .el-row {\n              .el-col {\n                .el-form-item {\n                  width: 100% !important;\n\n                  .el-form-item__label {\n                    font-weight: normal !important;\n                  }\n\n                  .el-form-item__content {\n                    .el-input-number {\n                      width: 100% !important;\n                    }\n                  }\n                }\n\n                .labelless {\n                  .el-form-item__label  {\n                    visibility: hidden;\n                  }\n                }\n              }\n            }\n          }\n        }\n\n        &.small-label {\n          .el-form-item__label {\n            font-size: 1rem !important;\n          }\n        }\n      }\n\n      .el-form-item.flex-end {\n        margin: 0;\n\n        .el-form-item__content {\n          display: flex;\n          justify-content: flex-end;\n        }\n      }\n    }\n  }\n}\n</style>\n","import mod from \"-!../../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./EditDiscountsForm.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./EditDiscountsForm.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./EditDiscountsForm.vue?vue&type=template&id=f06975da&\"\nimport script from \"./EditDiscountsForm.vue?vue&type=script&lang=js&\"\nexport * from \"./EditDiscountsForm.vue?vue&type=script&lang=js&\"\nimport style0 from \"./EditDiscountsForm.vue?vue&type=style&index=0&id=f06975da&prod&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".discounts__form .el-row .el-col .el-form-item.flex-item{display:flex;flex-direction:column;align-items:flex-start}.discounts__form .el-row .el-col .el-form-item.flex-item .el-form-item__content{width:100%}.discounts__form .el-row .el-col .el-form-item.flex-item .el-form-item__content .el-form--inline .el-row .el-col .el-form-item{width:100%!important}.discounts__form .el-row .el-col .el-form-item.flex-item .el-form-item__content .el-form--inline .el-row .el-col .el-form-item .el-form-item__label{font-weight:400!important}.discounts__form .el-row .el-col .el-form-item.flex-item .el-form-item__content .el-form--inline .el-row .el-col .el-form-item .el-form-item__content .el-input-number{width:100%!important}.discounts__form .el-row .el-col .el-form-item.flex-item .el-form-item__content .el-form--inline .el-row .el-col .labelless .el-form-item__label{visibility:hidden}.discounts__form .el-row .el-col .el-form-item.flex-item.small-label .el-form-item__label{font-size:1rem!important}.discounts__form .el-row .el-col .el-form-item.flex-end{margin:0}.discounts__form .el-row .el-col .el-form-item.flex-end .el-form-item__content{display:flex;justify-content:flex-end}\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/views/main/billing/partials/partials/EditDiscountsForm.vue\"],\"names\":[],\"mappings\":\"AAIM,yDACE,YAAA,CACA,qBAAA,CACA,sBAAA,CAEA,gFACE,UAAA,CAKM,+HACE,oBAAA,CAEA,oJACE,yBAAA,CAIA,uKACE,oBAAA,CAMJ,iJACE,iBAAA,CASV,0FACE,wBAAA,CAKN,wDACE,QAAA,CAEA,+EACE,YAAA,CACA,wBAAA\",\"sourcesContent\":[\"\\n.discounts__form {\\n  .el-row {\\n    .el-col {\\n      .el-form-item.flex-item {\\n        display: flex;\\n        flex-direction: column;\\n        align-items: flex-start;\\n\\n        .el-form-item__content {\\n          width: 100%;\\n\\n          .el-form--inline {\\n            .el-row {\\n              .el-col {\\n                .el-form-item {\\n                  width: 100% !important;\\n\\n                  .el-form-item__label {\\n                    font-weight: normal !important;\\n                  }\\n\\n                  .el-form-item__content {\\n                    .el-input-number {\\n                      width: 100% !important;\\n                    }\\n                  }\\n                }\\n\\n                .labelless {\\n                  .el-form-item__label  {\\n                    visibility: hidden;\\n                  }\\n                }\\n              }\\n            }\\n          }\\n        }\\n\\n        &.small-label {\\n          .el-form-item__label {\\n            font-size: 1rem !important;\\n          }\\n        }\\n      }\\n\\n      .el-form-item.flex-end {\\n        margin: 0;\\n\\n        .el-form-item__content {\\n          display: flex;\\n          justify-content: flex-end;\\n        }\\n      }\\n    }\\n  }\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-22.use[1]!../../../../../../node_modules/@vue/vue-loader-v15/lib/loaders/stylePostLoader.js!../../../../../../node_modules/@vue/cli-service/node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-22.use[2]!../../../../../../node_modules/@vue/cli-service/node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-22.use[3]!../../../../../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-22.use[4]!../../../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./EditDiscountsForm.vue?vue&type=style&index=0&id=f06975da&prod&lang=scss&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"6c7faca4\", content, true, {\"sourceMap\":true,\"shadowMode\":false});"],"names":["render","_vm","this","_c","_self","visible","staticClass","attrs","form","_v","_l","discounts","discount","dIndex","key","on","$event","handleRemoveDiscount","model","value","callback","$$v","$set","expression","handleAddDiscount","handleCancel","loading","handleSave","directives","name","rawName","handleenableEdit","staticRenderFns","components","DiscountsDescription","SingleDiscountForm","props","contract","type","Object","required","customer","data","computed","mapGetters","discountsById","id","mounted","init","methods","mapActions","handleUpdateDiscountsList","handleShowLoading","getContractDiscountList","then","_","length","catch","error","$jusNotification","finally","promises","map","fn","changeContractDiscount","addContractDiscount","payload","contractId","discountId","Promise","all","title","message","push","minVolume","index","console","log","deleteContractDiscount","splice","component","___CSS_LOADER_EXPORT___","module","content","__esModule","default","locals","exports","add"],"sourceRoot":""}