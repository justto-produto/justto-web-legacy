(self["webpackChunk_projuris_justto_web"]=self["webpackChunk_projuris_justto_web"]||[]).push([[8282],{18282:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return d}});var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"client-grid"},[t("jus-grid",{attrs:{columns:4}},[e._l(e.custumerList,(function(i,o){return t("div",{key:o,staticClass:"client-grid__card"},[t("h1",{staticClass:"client-grid__card__holding center mb0"},[e.isEditingHoldingName===i.id?t("el-autocomplete",{staticClass:"client-grid__autocomplete",attrs:{"fetch-suggestions":e.holdingQuerySearch,placeholder:"Digite o nome da holding","value-key":"name"},on:{select:function(t){return e.handleChangeHoldingName(i)}},model:{value:e.holdingName,callback:function(t){e.holdingName=t},expression:"holdingName"}},[t("i",{staticClass:"el-icon-close el-input__icon",attrs:{slot:"suffix"},on:{click:e.handleCleanHoldingEditing},slot:"suffix"}),t("i",{staticClass:"el-icon-check el-input__icon",attrs:{slot:"suffix"},on:{click:function(t){return e.handleChangeHoldingName(i)}},slot:"suffix"})]):t("JusTextEditable",{staticClass:"jus-user-card__title",attrs:{value:e.getHoldingName(i.holdingId),type:"title"},on:{isEditing:function(t){return e.handleEnableEditExistingHolding(i)}}})],1),t("el-divider",{staticClass:"mb0"}),t("jus-user-card",{staticClass:"client-grid__card__customer",attrs:{"user-data":i},on:{"edit-title":e.handleEditTitle,"see-more":e.handleSeeMore,edit:e.handleEdit,close:e.handleClose}})],1)})),e.formCardIsVisible?t("el-card",{staticClass:"client-grid__form-card",attrs:{shadow:"always"}},[t("span",{staticClass:"client-grid__form-title"},[e._v(" Digite o nome da Holding para buscar uma existente, ou criar uma nova. ")]),t("el-autocomplete",{staticClass:"client-grid__autocomplete",attrs:{"fetch-suggestions":e.holdingQuerySearch,placeholder:"Digite o nome da holding","value-key":"name"},on:{input:e.handleHoldingChange},model:{value:e.holdingName,callback:function(t){e.holdingName=t},expression:"holdingName"}}),e.holdingName?t("span",{staticClass:"client-grid__form-title"},[e._v(" Digite o nome do cliente abaixo para buscar um existente ou criar um novo. ")]):e._e(),e.holdingName?t("el-autocomplete",{staticClass:"client-grid__autocomplete",attrs:{"fetch-suggestions":e.querySearch,placeholder:"Ex.: José da Silva","value-key":"name"},on:{input:e.handleValueChange},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}}):e._e(),e.inputValue?t("span",{staticClass:"client-grid__form-title"},[e._v(" Tipo de cliente: ")]):e._e(),e.inputValue?t("el-select",{staticClass:"client-grid__autocomplete",attrs:{placeholder:"Tipo de cliente"},model:{value:e.negotiationType,callback:function(t){e.negotiationType=t},expression:"negotiationType"}},[t("el-option",{attrs:{label:"Cobrança",value:"COBRANCA"}}),t("el-option",{attrs:{label:"Indenizatório",value:"INDENIZATORIO"}})],1):e._e(),e.inputValue?t("span",{staticClass:"client-grid__form-title"},[e._v(" Mensalidade: ")]):e._e(),e.inputValue?t("div",{staticClass:"el-input"},[e.inputValue?t("money",{staticClass:"el-input__inner client-grid__autocomplete",model:{value:e.monthlySubscriptionFee,callback:function(t){e.monthlySubscriptionFee=t},expression:"monthlySubscriptionFee"}}):e._e()],1):e._e(),e.inputValue?t("el-button",{staticClass:"client-grid__btn",attrs:{type:"primary"},nativeOn:{click:function(t){return e.addClient.apply(null,arguments)}}},[e._v(" Vincular cliente ")]):e._e()],1):t("el-card",{staticClass:"client-grid__action-card",attrs:{shadow:"hover"},nativeOn:{click:function(t){return e.showFormCard.apply(null,arguments)}}},[t("span",[e._v("Adicionar um cliente")]),t("i",{staticClass:"el-icon-plus client-grid__icon"})])],2),t("ContractsCardsModal",{attrs:{plans:e.plans,visible:e.dialogFormVisible}})],1)},n=[],l=(i(57658),i(90408)),r={name:"ClientGrid",components:{JusGrid:()=>i.e(6789).then(i.bind(i,46789)),JusUserCard:()=>i.e(9863).then(i.bind(i,9863)),ContractsCardsModal:()=>i.e(4613).then(i.bind(i,34613)),JusTextEditable:()=>i.e(3815).then(i.bind(i,33815))},data(){return{dialogFormVisible:!1,formCardIsVisible:!1,inputValue:"",monthlySubscriptionFee:0,negotiationType:null,isEditingHoldingName:!1,holdingName:""}},computed:{...(0,l.Se)({custumerList:"getMyCusomers",isJusttoAdmin:"isJusttoAdmin",isAdminProfile:"isAdminProfile",currentCustomer:"getCurrentCustomer",custumerSuggestions:"getAllCusomers",plans:"getPlans",workspaceId:"workspaceId",holdingSuggestions:"getHoldingsList"}),isSuggestion(){return this.custumerSuggestions.filter((({name:e})=>e===this.inputValue)).length>0},getHoldingName(){return e=>this.holdingSuggestions.find((({id:t})=>Number(e)===Number(t)))?.name||""}},created(){this.init()},methods:{...(0,l.nv)(["addCustomer","associateCustomer","getAllCustomers","getMyCusomers","getPlans","setCustomer","setWorkspaceId","unlinkCustomer","updateCustomer","getHoldings","createHolding"]),init(){this.isJusttoAdmin||this.isAdminProfile?(this.getPlans().then((()=>{this.getMyCusomers().then((()=>{this.getAllCustomers().then((()=>{this.setWorkspaceId(this.workspaceId),this.$nextTick((()=>{this.isAdminProfile&&!this.isJusttoAdmin&&this.getCustomerToRedirect().then((e=>{this.setCustomer(e),this.$router.push(`/billing/${e.id}`)})).catch((()=>{this.$router.go(-1),this.$jusNotification({title:"Ops!",message:"Nenhum cliente com contratos do tipo escritório nesta workspace.",type:"error"})}))}))}))}))})),this.getHoldings("").catch((e=>this.$jusNotification({error:e})))):(this.$router.push("/management"),this.$jusNotification({title:"Ops!",message:"Você não pode entra ai. Fale com um administrador",type:"warning"}))},getCustomerToRedirect(){return new Promise(((e,t)=>{if(1===this.custumerList.length){const t=this.custumerList[0];e(t)}else{for(const t of this.plans)if(![10,5,8].includes(Number(t.id)))for(const i of this.custumerList)for(const o of i.contracts)o.planId===t.id&&e(i);t(new Error("Sem customers com clientes com contratos do tipo Escritório."))}}))},handleEditTitle(e){this.updateCustomer(e)},querySearch(e,t){const i=this.custumerSuggestions,o=e?i.filter(this.createFilter(e)):i;t(o)},holdingQuerySearch(e,t){const i=this.holdingSuggestions,o=e?i.filter(this.createFilter(e)):i;t(o)},createFilter(e){return t=>0===t.name.toLowerCase().indexOf(e.toLowerCase())},handleSeeMore(e){this.setCustomer(e),this.$router.push(`/billing/${e.id}`)},handleEdit(e){this.setCustomer(e),this.form=this.currentCustomer,this.dialogFormVisible=!this.dialogFormVisible},handleClose(e){this.$confirm("Tem certeza que deseja desvincular este cliente dassa workspace?","Atenção",{confirmButtonText:"Continuar",cancelButtonText:"Cancelar",type:"warning"}).then((()=>{this.unlinkCustomer(e.id).then((()=>{this.$jusNotification({type:"success",title:"Yay!",message:"Cliente desvinculado com sucesso."})}))}))},handleFilterHoldingByName(){const e=this.holdingSuggestions.map((({name:e})=>e)).indexOf(this.holdingName);return new Promise((t=>{e<0&&t(this.createHolding(this.holdingName)),t(this.holdingSuggestions[e])}))},async handleAssssiateHolding(e,t){return t?.holdingId===e?Promise.resolve():this.updateCustomer({...t,holdingId:e})},async addClient(){const e=this.inputValue,t=(await this.handleFilterHoldingByName())?.id,i=this.custumerSuggestions.filter((t=>t.name===e)),{negotiationType:o,monthlySubscriptionFee:n}=this;i.length?(await this.handleAssssiateHolding(t,i[0]),this.associateCustomer(i[0].id)):this.addCustomer({name:e,holdingId:t,negotiationType:o,monthlySubscriptionFee:n}),this.hideFormCard()},showFormCard(){this.formCardIsVisible=!0},hideFormCard(){this.formCardIsVisible=!1,this.inputValue="",this.negotiationType=null},handleValueChange(){(this.custumerSuggestions||[]).forEach((({name:e,negotiationType:t})=>{e===this.inputValue&&(this.negotiationType=t)}))},handleHoldingChange(){(this.holdingSuggestions||[]).forEach((({name:e})=>e===this.holdingName))},handleEnableEditExistingHolding(e){this.isEditingHoldingName=e.id,this.holdingName=this.getHoldingName(e.holdingId)},async handleChangeHoldingName(e){const t=(await this.handleFilterHoldingByName())?.id;this.$confirm(`Deseja realmente editar a holding do cliente${e?.name?` ${e?.name}`:""}?`,{confirmButtonText:"Sim",cancelButtonText:"Não",showClose:!1}).then((i=>{this.updateCustomer({...e,holdingId:t}).then((()=>this.$jusNotification({type:"success",message:"Holding editada com sucesso."}))).catch((e=>this.$jusNotification({error:e})))})).finally(this.handleCleanHoldingEditing)},handleCleanHoldingEditing(){this.isEditingHoldingName=!1,this.holdingName=""}}},a=r,s=(i(72563),i(1001)),c=(0,s.Z)(a,o,n,!1,null,null,null),d=c.exports},60298:function(e,t,i){"use strict";i.r(t);var o=i(87537),n=i.n(o),l=i(23645),r=i.n(l),a=r()(n());a.push([e.id,".client-grid__action-card>.el-card__body{padding:10px!important;background-color:#8ae698;color:#2b8739;cursor:pointer;display:flex;font-size:18px;font-weight:700;height:100%;align-items:center;justify-content:center}.client-grid__action-card .client-grid__icon{font-size:24px;margin-left:8px}.client-grid__form-card>.el-card__body{align-items:center;display:flex;flex-direction:column;height:100%;justify-content:center}.client-grid__form-card>.el-card__body .client-grid__form-title{display:block;font-size:14px;font-weight:700;margin-bottom:16px}.client-grid__form-card>.el-card__body .client-grid__autocomplete{margin-bottom:16px;width:100%}.client-grid__form-card>.el-card__body .client-grid__autocomplete .el-input{overflow-x:hidden}.client-grid__form-card>.el-card__body .client-grid__btn{margin-top:8px}.client-grid__card{border:1px solid #018ef0;border-radius:11px 7px 7px 11px;background-color:#018ef0}.client-grid__card .client-grid__card__holding{background-color:transparent;color:#fff}.client-grid__card .client-grid__card__holding .jus-text-editable .edit-icon{filter:invert(1)}.client-grid__card .client-grid__card__holding .client-grid__autocomplete .el-input{overflow:hidden!important}.client-grid__card .client-grid__card__holding .client-grid__autocomplete .el-input .el-input__inner{background-color:#fff}.client-grid__card .client-grid__card__holding .client-grid__autocomplete .el-input .el-input__suffix .el-input__icon{cursor:pointer}.client-grid__card .client-grid__card__customer{border:none;border-radius:11px 7px 7px 11px;background-color:#fff}","",{version:3,sources:["webpack://./src/views/main/billing/partials/ClientGrid.vue","webpack://./node_modules/projuris-acordos-theme/src/common/colors.scss"],names:[],mappings:"AAKE,yCACE,sBAAA,CACA,wBC8CsB,CD7CtB,aAAA,CACA,cAAA,CACA,YAAA,CACA,cAAA,CACA,eAAA,CACA,WAAA,CACA,kBAAA,CACA,sBAAA,CAGF,6CACE,cAAA,CACA,eAAA,CAKF,uCACE,kBAAA,CACA,YAAA,CACA,qBAAA,CACA,WAAA,CACA,sBAAA,CAEA,gEACE,aAAA,CACA,cAAA,CACA,eAAA,CACA,kBAAA,CAGF,kEACE,kBAAA,CACA,UAAA,CAEA,4EACE,iBAAA,CAIJ,yDACE,cAAA,CAKN,mBACE,wBAAA,CACA,+BAAA,CACA,wBC5CsB,CD8CtB,+CACE,4BAAA,CACA,UAAA,CAGE,6EACE,gBAAA,CAKF,oFACE,yBAAA,CACA,qGACE,qBAAA,CAIA,sHACE,cAAA,CAOV,gDACE,WAAA,CACA,+BAAA,CACA,qBCrFY",sourcesContent:["\n@import '~projuris-acordos-theme/src/common/colors.scss';\n\n.client-grid__action-card {\n\n  & > .el-card__body {\n    padding: 10px !important;\n    background-color: $--color-success-light-5;\n    color: mix($--color-black, $--color-success, 50%);\n    cursor: pointer;\n    display: flex;\n    font-size: 18px;\n    font-weight: 700;\n    height: 100%;\n    align-items: center;\n    justify-content: center;\n  }\n\n  .client-grid__icon {\n    font-size: 24px;\n    margin-left: 8px;\n  }\n}\n\n.client-grid__form-card {\n  & > .el-card__body {\n    align-items: center;\n    display: flex;\n    flex-direction: column;\n    height: 100%;\n    justify-content: center;\n\n    .client-grid__form-title {\n      display: block;\n      font-size: 14px;\n      font-weight: 700;\n      margin-bottom: 16px;\n    }\n\n    .client-grid__autocomplete {\n      margin-bottom: 16px;\n      width: 100%;\n\n      .el-input {\n        overflow-x: hidden;\n      }\n    }\n\n    .client-grid__btn {\n      margin-top: 8px;\n    }\n  }\n}\n\n.client-grid__card {\n  border: solid 1px $--pj-color-light-blue;\n  border-radius: 11px 7px 7px 11px;\n  background-color: $--pj-color-light-blue;\n\n  .client-grid__card__holding {\n    background-color: transparent;\n    color: white;\n\n    .jus-text-editable {\n      .edit-icon {\n        filter: invert(1);\n      }\n    }\n\n    .client-grid__autocomplete {\n      .el-input {\n        overflow: hidden !important;\n        .el-input__inner {\n          background-color: #fff;\n        }\n\n        .el-input__suffix {\n          .el-input__icon {\n            cursor: pointer;\n          }\n        }\n      }\n    }\n  }\n\n  .client-grid__card__customer {\n    border: none;\n    border-radius: 11px 7px 7px 11px;\n    background-color: $--color-white;\n  }\n}\n","/* Colors\n-------------------------- */\n\n$--color-white: #fff !default;\n$--color-black: #424242 !default;\n$--color-gray: #979797 !default;\n$--color-gray-light-1: mix($--color-white, $--color-gray, 10%) !default;\n$--color-light-gray: #f3f4f5 !default;\n$--color-whatsapp: #075E54 !default;\n\n$--pj-color-darker-blue: #0A0022 !default;\n$--pj-color-dark-blue: #280BA0 !default;\n$--pj-color-blue: #0756e4 !default;\n$--pj-color-light-blue: #018EF0 !default;\n$--pj-color-lighter-blue: #30A9FB !default;\n$--pj-color-white-blue: #F0F9FE !default;\n$--pj-color-disabled-blue: #9ad2f9 !default;\n\n$-pg-color-overlay: #19415F !default;\n\n$--pj-color-red: #CC4148 !default;\n$--pj-color-light-red: #EC767C !default;\n$--pj-color-disable-red: #FFF2F3 !default;\n\n$--color-primary: $--pj-color-blue !default;\n$--color-primary-light-1: mix($--color-white, $--color-primary, 10%) !default;\n$--color-primary-light-2: mix($--color-white, $--color-primary, 20%) !default;\n$--color-primary-light-3: mix($--color-white, $--color-primary, 30%) !default;\n$--color-primary-light-4: mix($--color-white, $--color-primary, 40%) !default;\n$--color-primary-light-5: mix($--color-white, $--color-primary, 50%) !default;\n$--color-primary-light-6: mix($--color-white, $--color-primary, 60%) !default;\n$--color-primary-light-7: mix($--color-white, $--color-primary, 70%) !default;\n$--color-primary-light-8: mix($--color-white, $--color-primary, 80%) !default;\n$--color-primary-light-9: mix($--color-white, $--color-primary, 90%) !default;\n\n$--color-secondary: $--pj-color-light-blue !default;\n$--color-secondary-light-1: mix($--color-white, $--color-secondary, 10%) !default;\n$--color-secondary-light-2: mix($--color-white, $--color-secondary, 20%) !default;\n$--color-secondary-light-3: mix($--color-white, $--color-secondary, 30%) !default;\n$--color-secondary-light-4: mix($--color-white, $--color-secondary, 40%) !default;\n$--color-secondary-light-5: mix($--color-white, $--color-secondary, 50%) !default;\n$--color-secondary-light-6: mix($--color-white, $--color-secondary, 60%) !default;\n$--color-secondary-light-7: mix($--color-white, $--color-secondary, 70%) !default;\n$--color-secondary-light-8: mix($--color-white, $--color-secondary, 80%) !default;\n$--color-secondary-light-9: mix($--color-white, $--color-secondary, 90%) !default;\n\n$--color-primary-dark: $--pj-color-dark-blue !default;\n$--color-success: #14CC30 !default;\n$--color-warning: #FFC900 !default;\n$--color-danger: #FF4B54 !default;\n$--color-info: #2FBBEC !default;\n\n$--color-success-light-1: mix($--color-white, $--color-success, 10%) !default;\n$--color-success-light-5: mix($--color-white, $--color-success, 50%) !default;\n$--color-warning-light-5: mix($--color-white, $--color-warning, 50%) !default;\n$--color-danger-light-5: mix($--color-white, $--color-danger, 50%) !default;\n$--color-danger-light-3: mix($--color-white, $--color-danger, 30%) !default;\n$--color-info-light-5: mix($--color-white, $--color-info, 50%) !default;\n\n$--color-success-light: mix($--color-white, $--color-success, 80%) !default;\n$--color-warning-light: mix($--color-white, $--color-warning, 80%) !default;\n$--color-danger-light: mix($--color-white, $--color-danger, 80%) !default;\n$--color-info-light: mix($--color-white, $--color-info, 80%) !default;\n\n$--color-success-lighter: mix($--color-white, $--color-success, 90%) !default;\n$--color-warning-lighter: mix($--color-white, $--color-warning, 90%) !default;\n$--color-danger-lighter: mix($--color-white, $--color-danger, 90%) !default;\n$--color-info-lighter: mix($--color-white, $--color-info, 90%) !default;\n\n$--color-text-primary: $--color-black !default;\n$--color-text-secondary: $--color-gray !default;\n\n$--color-nps-promoter: #14CC30 !default;\n$--color-nps-neutral: #979797 !default;\n$--color-nps-detractor: #FF4B54 !default;\n\n$--color-negotiator-bg: #9461f74f !default;\n$--color-email-bg: $--color-info-light !default;\n$--color-whatsapp-bg: $--color-success-light-5 !default;"],sourceRoot:""}]),t["default"]=a},72563:function(e,t,i){var o=i(60298);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var n=i(39185).Z;n("bcdfd736",o,!0,{sourceMap:!0,shadowMode:!1})}}]);
//# sourceMappingURL=8282.js.map