(self["webpackChunk_projuris_justto_web"]=self["webpackChunk_projuris_justto_web"]||[]).push([[9624],{9624:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return u}});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"panel-workspace-view"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],key:e.tableKey,attrs:{data:e.filteredWorkspaces,width:"100%"},on:{"expand-change":e.getUsersByWorkspace}},[t("el-table-column",{attrs:{type:"expand",fixed:"left",width:"50px"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("el-table",{key:e.usersTableKey,attrs:{data:e.users[o.row.id],size:"small",width:"100%"}},[t("el-table-column",{attrs:{prop:"name",label:"Nome"}}),t("el-table-column",{attrs:{prop:"profile",label:"Perfil"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("capitalize")(e.$t("profile."+t.row.profile)))+" ")]}}],null,!0)}),t("el-table-column",{attrs:{align:"right",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-tooltip",{attrs:{"open-delay":800,content:"Remover usuário"}},[t("el-button",{staticStyle:{color:"#FF4B54"},attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(t){return e.removeWorkspaceUser(o.row.id,s.row.id)}}})],1)]}}],null,!0)})],1)]}}])}),t("el-table-column",{attrs:{prop:"name",label:"Nome"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("el-input",{directives:[{name:"show",rawName:"v-show",value:o.row.editing,expression:"props.row.editing"}],ref:"input"+o.row.id,on:{blur:function(t){o.row.editing=!1,e.editWorkspaceName(o.row)}},nativeOn:{keyup:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;o.row.editing=!1,e.editWorkspaceName(o.row)}},model:{value:o.row.name,callback:function(t){e.$set(o.row,"name",t)},expression:"props.row.name"}}),t("div",{directives:[{name:"show",rawName:"v-show",value:!o.row.editing,expression:"!props.row.editing"}],staticClass:"label panel-workspace-view__editable-label",on:{click:function(t){o.row.editing=!0,e.focusInput(o.row.id,o.row.name)}}},[e._v(" "+e._s(o.row.name)+" "),t("jus-icon",{staticClass:"edit-icon",attrs:{icon:"edit"}})],1)]}}])}),t("el-table-column",{attrs:{prop:"teamName",label:"Nome de exibição"}}),t("el-table-column",{attrs:{prop:"status",label:"Status",width:"80px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("capitalize")(e.$t("workspace."+t.row.status)))+" ")]}}])}),t("el-table-column",{attrs:{fixed:"right",align:"right"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("el-tooltip",{attrs:{"open-delay":800,content:"DISABLED"===o.row.status?"Equipe desabilitada":"Convidar usuário"}},[t("span",{staticStyle:{"margin-right":"10px"}},[t("el-button",{attrs:{disabled:"DISABLED"===o.row.status,size:"mini",type:"",icon:"el-icon-plus"},on:{click:function(t){return e.addUserDialog(o.row)}}})],1)]),t("el-tooltip",{attrs:{"open-delay":800,content:"Editar equipe"}},[t("el-button",{attrs:{size:"mini",type:"",icon:"el-icon-edit"},on:{click:function(t){return e.editWorkspaceDialog(o.row)}}})],1)]}}])})],1),t("el-backtop",{ref:"backTop",attrs:{target:".panel-workspace-view"}}),t("el-dialog",{attrs:{visible:e.addUserDialogVisible,title:"Convidar usuário",width:"50%"},on:{"update:visible":function(t){e.addUserDialogVisible=t}},nativeOn:{submit:function(t){return t.preventDefault(),e.addUser.apply(null,arguments)}}},[t("el-form",{ref:"userForm",attrs:{model:e.userForm,rules:e.userRules,"label-position":"top"}},[t("el-form-item",{attrs:{label:"E-mail",prop:"email"}},[t("el-input",{model:{value:e.userForm.email,callback:function(t){e.$set(e.userForm,"email",t)},expression:"userForm.email"}})],1),t("el-form-item",{attrs:{label:"Perfil",prop:"profile"}},[t("el-select",{model:{value:e.userForm.profile,callback:function(t){e.$set(e.userForm,"profile",t)},expression:"userForm.profile"}},e._l(["NEGOTIATOR","ADMINISTRATOR"],(function(o){return t("el-option",{key:o,attrs:{label:e.$t("profile."+o).toUpperCase(),value:o}})})),1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{plain:""},on:{click:function(t){e.addUserDialogVisible=!1}}},[e._v("Cancelar")]),t("el-button",{attrs:{type:"primary"},on:{click:e.addUser}},[e._v("Convidar")])],1)],1),t("el-dialog",{attrs:{visible:e.editWorkspaceDialogVisible,title:"Editar equipe",width:"50%"},on:{"update:visible":function(t){e.editWorkspaceDialogVisible=t}},nativeOn:{submit:function(t){return t.preventDefault(),e.editWorkspace.apply(null,arguments)}}},[t("el-form",{ref:"workspaceForm",attrs:{model:e.workspaceForm,rules:e.workspaceRules,"label-position":"top"}},[t("h3",[e._v("Alterar nome da equipe")]),t("el-alert",{attrs:{closable:!1,type:"info","show-icon":""}},[t("span",{attrs:{slot:"title"},slot:"title"},[e._v(" Este nome "),t("strong",[e._v("NÃO")]),e._v(" irá aparecer nas mensagens automáticas. Utilize-o para organização interna. ")])]),t("br"),t("el-form-item",{attrs:{label:"Nome da equipe",prop:"name"}},[t("el-input",{model:{value:e.workspaceForm.name,callback:function(t){e.$set(e.workspaceForm,"name",t)},expression:"workspaceForm.name"}})],1),t("h3",[e._v("Alterar nome da empresa/escritório")]),t("el-alert",{attrs:{closable:!1,type:"info","show-icon":""}},[t("span",{attrs:{slot:"title"},slot:"title"},[e._v(" Este nome "),t("strong",[e._v("IRÁ")]),e._v(" aparecer em todas as mensagens automáticas enviadas pela ProJuris. ")])]),t("br"),t("el-form-item",{attrs:{label:"Nome de exibição",prop:"teamName"}},[t("el-input",{model:{value:e.workspaceForm.teamName,callback:function(t){e.$set(e.workspaceForm,"teamName",t)},expression:"workspaceForm.teamName"}})],1),t("h3",[e._v("Configurações gerais da equipe")]),t("el-form-item",{attrs:{label:"Status",prop:"status"}},[t("el-select",{model:{value:e.workspaceForm.status,callback:function(t){e.$set(e.workspaceForm,"status",t)},expression:"workspaceForm.status"}},e._l(["READY","DISABLED"],(function(o){return t("el-option",{key:o,attrs:{label:e.$t("workspace."+o).toUpperCase(),value:o}})})),1)],1),t("el-form-item",{attrs:{label:"Como detectar possíveis ofensores em sua carteira?",prop:"vexatiousType"}},[t("el-select",{model:{value:e.workspaceForm.properties.VEXATIOUS_TYPE,callback:function(t){e.$set(e.workspaceForm.properties,"VEXATIOUS_TYPE",t)},expression:"workspaceForm.properties.VEXATIOUS_TYPE"}},e._l(["QUANTITY","AVERAGE"],(function(o){return t("el-option",{key:o,attrs:{label:e.$t(`threshold.${o}`),value:o}})})),1)],1),e.workspaceForm.properties.VEXATIOUS_TYPE?t("el-form-item",{attrs:{prop:"vexatiousThreshold"}},[t("span",{attrs:{slot:"label"},slot:"label"},["QUANTITY"===e.workspaceForm.properties.VEXATIOUS_TYPE?t("span",[e._v("Quantas disputas uma mesma pessoa precisa ter para ser qualificado como possível ofensor?")]):t("span",[e._v("Qual percentual acima da média de disputas uma pessoa precisa ter para ser qualificado como possível ofensor?")])]),t("div",{staticClass:"el-input"},[t("money",e._b({staticClass:"el-input__inner",model:{value:e.workspaceForm.properties.VEXATIOUS_THRESHOLD,callback:function(t){e.$set(e.workspaceForm.properties,"VEXATIOUS_THRESHOLD",t)},expression:"workspaceForm.properties.VEXATIOUS_THRESHOLD"}},"money",e.vexatiousTypeMask,!1))],1)]):e._e()],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{plain:""},on:{click:function(t){e.editWorkspaceDialogVisible=!1}}},[e._v("Cancelar")]),t("el-button",{attrs:{type:"primary"},on:{click:e.editWorkspace}},[e._v("Editar")])],1)],1)],1)},a=[],r=(o(57658),o(40917)),i=o(90408),l={name:"PanelWorkspace",props:{filterTerm:{type:String,default:""}},data(){return{loading:!1,addUserDialogVisible:!1,editWorkspaceDialogVisible:!1,workspaceNameToEdit:"",workspaces:[],tableKey:0,usersTableKey:0,users:{},userForm:{email:"",profile:""},userRules:{email:[{required:!0,message:"Campo obrigatório",trigger:"submit"},{type:"email",required:!0,message:"Insira um e-mail válido",trigger:["submit"]}],profile:[{required:!0,message:"Campo obrigatório",trigger:"submit"}]},workspaceForm:{name:"",teamName:"",status:"",vexatiousType:"",vexatiousThreshold:"",properties:{VEXATIOUS_THRESHOLD:"",VEXATIOUS_TYPE:""}},workspaceRules:{name:[{required:!0,message:"Campo obrigatório",trigger:"submit"}]},debounce:()=>{},filterTermDebounced:""}},computed:{...(0,i.Se)({workspace:"workspace"}),filteredWorkspaces(){return(0,r.FO)(this.filterTermDebounced,this.workspaces,"name","teamName")},vexatiousTypeMask(){return{decimal:"",thousands:"",prefix:"",suffix:"AVERAGE"===this.workspaceForm.properties.VEXATIOUS_TYPE?" %":"",precision:0,masked:!1}}},watch:{filterTerm(e){clearTimeout(this.debounce),this.debounce=setTimeout((()=>{this.filterTermDebounced=e}),800)}},beforeMount(){this.fetchData()},methods:{fetchData(){this.loading=!0,this.$store.dispatch("adminWorkspaces",{method:"get",params:{size:99999}}).then((e=>{this.workspaces=e?.content||[],this.tableKey+=1})).catch((e=>{this.$jusNotification({error:e})})).finally((()=>{this.loading=!1}))},getUsersByWorkspace(e){let t;t="object"===typeof e?e.id:e,this.users[t]||this.$store.dispatch("adminWorkspaceUsers",{method:"get",workspaceId:t}).then((t=>{const o=[];for(const e of t)o.push({name:e.person.name,documentNumber:e.person.documentNumber,profile:e.profile,id:e.id});this.users[e.id]=o,this.usersTableKey+=1})).catch((e=>{this.$jusNotification({error:e})}))},addUserDialog(e){this.userForm={email:"",profile:"",workspaceId:e.id,workspaceSubdomain:e.subDomain},this.addUserDialogVisible=!0},addUser(){this.$refs.userForm.validate((e=>{if(e){const e=this.$loading({lock:!0});this.$store.dispatch("adminWorkspaceUsers",{method:"post",url:`api/accounts/workspaces/invite-teammates/${this.workspace.subDomain}`,data:[{email:this.userForm.email,profile:this.userForm.profile}],headers:{Workspace:this.userForm.workspaceSubdomain}}).then((e=>{this.$jusNotification({title:"Yay!",message:"Convite enviado com sucesso.",type:"success"}),this.userForm.email="",this.userForm.profile="NEGOTIATOR",delete this.users[this.userForm.workspaceId],this.tableKey+=1,this.usersTableKey+=1,this.getUsersByWorkspace(this.userForm.workspaceId)})).catch((e=>{this.$jusNotification({error:e})})).finally((()=>{e.close(),this.addUserDialogVisible=!1}))}}))},editWorkspaceDialog(e){this.editWorkspaceDialogVisible=!0,this.workspaceForm=JSON.parse(JSON.stringify(e))},editWorkspace(){this.$refs.workspaceForm.validate((e=>{if(e){const e=this.$loading({lock:!0});this.$store.dispatch("adminWorkspaces",{method:"put",data:this.workspaceForm}).then((()=>{this.fetchData(),this.$jusNotification({title:"Yay!",message:"Equipe editada com sucesso.",type:"success"})})).catch((e=>{this.$jusNotification({error:e})})).finally((()=>{e.close(),this.editWorkspaceDialogVisible=!1}))}}))},removeWorkspace(e){this.$confirm("Tem certeza que deseja remover esta equipe?","Atenção!",{confirmButtonText:"Remover",cancelButtonText:"Cancelar",type:"warning"}).then((()=>{const t=this.$loading({lock:!0});this.$store.dispatch("adminWorkspaces",{method:"delete",workspaceId:e}).then((()=>{this.$jusNotification({title:"Yay!",message:"Equipe removida com sucesso.",type:"success"})})).catch((e=>{this.$jusNotification({error:e})})).finally((()=>{t.close()}))}))},removeWorkspaceUser(e,t){this.$confirm("Tem certeza que deseja remover este usuário da equipe?","Atenção!",{confirmButtonText:"Remover",cancelButtonText:"Cancelar",type:"warning"}).then((()=>{const o=this.$loading({lock:!0});this.$store.dispatch("adminWorkspaceUsers",{method:"delete",userId:t}).then((()=>{this.$jusNotification({title:"Yay!",message:"Usuário removido com sucesso.",type:"success"}),delete this.users[e],this.tableKey+=1,this.usersTableKey+=1,this.getUsersByWorkspace(e)})).catch((e=>{this.$jusNotification({error:e})})).finally((()=>{o.close()}))}))},editWorkspaceName(e){this.tableKey+=1,e.name!==this.workspaceNameToEdit&&this.$store.dispatch("adminWorkspaces",{method:"put",data:e})},focusInput(e,t){this.tableKey+=1,this.workspaceNameToEdit=t,this.$nextTick((()=>this.$refs["input"+e].$el.children[0].focus()))}}},n=l,p=(o(53164),o(1001)),c=(0,p.Z)(n,s,a,!1,null,null,null),u=c.exports},56170:function(e,t,o){"use strict";o.r(t);var s=o(87537),a=o.n(s),r=o(23645),i=o.n(r),l=i()(a());l.push([e.id,".panel-workspace-view{padding:0 40px;overflow:auto}.panel-workspace-view .el-table__expanded-cell{padding:10px 0 10px 50px}.panel-workspace-view .el-table__expanded-cell .hover-row td{background-color:#fff!important}.panel-workspace-view .el-table__expanded-cell th{background-color:#f7f7f7}.panel-workspace-view .el-form--label-top .el-form-item__label{line-height:normal!important;margin-bottom:8px}.panel-workspace-view__editable-label .edit-icon{display:none;cursor:pointer;width:16px}.panel-workspace-view__editable-label:hover .edit-icon{display:inline}","",{version:3,sources:["webpack://./src/views/adminPanel/partials/PanelWorkspace.vue"],names:[],mappings:"AACA,sBACE,cAAA,CACA,aAAA,CACA,+CACE,wBAAA,CACA,6DACE,+BAAA,CAEF,kDACE,wBAAA,CAGJ,+DACE,4BAAA,CACA,iBAAA,CAGA,iDACE,YAAA,CACA,cAAA,CACA,UAAA,CAGA,uDACE,cAAA",sourcesContent:["\n.panel-workspace-view {\n  padding: 0 40px;\n  overflow: auto;\n  .el-table__expanded-cell {\n    padding: 10px 0px 10px 50px;\n    .hover-row td {\n      background-color: #fff !important;\n    }\n    th {\n      background-color: #f7f7f7;\n    }\n  }\n  .el-form--label-top .el-form-item__label {\n    line-height: normal !important;\n    margin-bottom: 8px;\n  }\n  &__editable-label {\n    .edit-icon {\n      display: none;\n      cursor: pointer;\n      width: 16px;\n    }\n    &:hover {\n      .edit-icon {\n        display: inline;\n      }\n    }\n  }\n}\n"],sourceRoot:""}]),t["default"]=l},53164:function(e,t,o){var s=o(56170);s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals);var a=o(39185).Z;a("55fe8dde",s,!0,{sourceMap:!0,shadowMode:!1})}}]);
//# sourceMappingURL=9624.js.map