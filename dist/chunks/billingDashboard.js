(self["webpackChunk_projuris_justto_web"]=self["webpackChunk_projuris_justto_web"]||[]).push([[5068],{39415:function(i,t,e){"use strict";e.r(t),e.d(t,{default:function(){return u}});var a=function(){var i=this,t=i._self._c;return t("jus-view-main",{staticClass:"billing-view",attrs:{"loading-container":!1,"full-screen":""}},[t("div",{staticClass:"billing-view__slot-main",attrs:{slot:"main"},slot:"main"},[i.isJusttoAdmin?t("jus-button-back",{staticClass:"billing-view__back-button",attrs:{to:"/billing"}}):i._e(),t("article",{staticClass:"billing-view__range"},[t("h2",{staticClass:"billing-view__range-title"},[i._v(" Cobrança do período "),t("el-date-picker",{staticClass:"billing-view__range-input",attrs:{clearable:!1,type:"daterange",align:"right",format:"dd/MM/yyyy","unlink-panels":"","range-separator":"-","start-placeholder":"Data inicial","end-placeholder":"Data final","value-format":"yyyy-MM-dd"},on:{input:i.filterByRangeDate},model:{value:i.dateRange,callback:function(t){i.dateRange=t},expression:"dateRange"}}),i._v(" de "+i._s(i.getCurrentCustomer.customerName)+" ")],1)]),t("jus-grid",{staticClass:"billing-view__cards",attrs:{rows:2,columns:4,flow:"column"}},[i._l(i.dataCards,(function(e,a){return t("jus-financial-card",{directives:[{name:"grid-item",rawName:"v-grid-item.col-1.row-1",modifiers:{"col-1":!0,"row-1":!0}},{name:"grid-item",rawName:"v-grid-item.col-1.row-2:v-if",value:6===a,expression:"index === 6",modifiers:{"col-1":!0,"row-2:v-if":!0}}],key:a,attrs:{data:e.data,actions:e.actions},on:{cardAction:i.handlerAction}})})),t("jus-financial-card",{directives:[{name:"grid-item",rawName:"v-grid-item.col-1.row-1",modifiers:{"col-1":!0,"row-1":!0}}],attrs:{data:i.totalCard.data,actions:i.totalCard.actions,highlighted:""},on:{cardAction:i.handlerAction}})],2),t("article",{staticClass:"billing-view__table"},[t("div",{staticClass:"billing-view__table-header"},[t("el-input",{staticClass:"billing-view__table-filter-input",attrs:{"prefix-icon":"el-icon-search",placeholder:"Buscar",size:"small",clearable:""},on:{input:i.filterByTerm},model:{value:i.searchTerm,callback:function(t){i.searchTerm=t},expression:"searchTerm"}}),t("span",{staticClass:"billing-view__table-filter-counter"},[i._v(" "+i._s(i.tableSubtitle)+" ")])],1),t("el-card",{staticClass:"billing-view__table-body",attrs:{shadow:"never"}},[t("JusDataTable",{staticClass:"billing-view__data-table",attrs:{data:i.transactionsList,pagination:i.transactionsPagination,loading:i.tableLoading,"loading-text":"Aguarde enquanto buscamos seus lançamentos financeiros ..."},on:{floatAction:i.handlerAction,infiniteHandler:i.infiniteHandler}})],1)],1),t("el-dialog",{attrs:{"close-on-click-modal":!1,"show-close":!1,visible:i.addTransactionDialogVisable,title:i.addTransactionForm.title,width:"50%"},on:{"update:visible":function(t){i.addTransactionDialogVisable=t}}},[t("el-form",{directives:[{name:"loading",rawName:"v-loading",value:i.modalLoading,expression:"modalLoading"}],ref:"addTransactionForm",attrs:{model:i.addTransactionForm}},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"Valor",prop:"value"}},[t("div",{staticClass:"el-input"},[t("money",{staticClass:"el-input__inner",attrs:{maxlength:"16"},model:{value:i.addTransactionForm.value,callback:function(t){i.$set(i.addTransactionForm,"value",t)},expression:"addTransactionForm.value"}})],1)])],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"Data",prop:"occurredDate"}},[t("el-date-picker",{attrs:{format:"dd/MM/yyyy","value-format":"yyyy-MM-dd",type:"date"},model:{value:i.addTransactionForm.occurredDate,callback:function(t){i.$set(i.addTransactionForm,"occurredDate",t)},expression:"addTransactionForm.occurredDate"}})],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",[t("el-form-item",{attrs:{label:"Nota",prop:"note"}},[t("el-input",{attrs:{type:"textarea",rows:"4"},model:{value:i.addTransactionForm.note,callback:function(t){i.$set(i.addTransactionForm,"note",t)},expression:"addTransactionForm.note"}})],1)],1)],1)],1),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{disabled:i.modalLoading},on:{click:function(t){i.addTransactionDialogVisable=!1}}},[i._v(" Cancelar ")]),t("el-button",{attrs:{loading:i.modalLoading,type:"primary"},on:{click:function(t){return t.preventDefault(),i.handlerModalTrigger(i.addTransactionForm.trigger)}}},[i._v(" Continuar ")])],1)],1)],1)])},n=[];e(57658);const o=(i,t)=>i.filter((i=>i.split("-")[0]===t))[0].split("-")[1],l={bind:(i,t)=>{const e=Object.keys(t.modifiers),a=o(e,"col"),n=o(e,"row");i.style.gridColumn=`span ${a}`,i.style.gridRow=`span ${n}`}};var r=e(90408),s={name:"BillingDashboard",directives:{GridItem:l},components:{JusDataTable:()=>e.e(200).then(e.bind(e,70200)),JusFinancialCard:()=>e.e(1476).then(e.bind(e,91476)),JusGrid:()=>e.e(6789).then(e.bind(e,46789))},data(){return{dateRange:[],searchTerm:"",addTransactionDialogVisable:!1,modalLoading:!1,addTransactionForm:{note:"",occurredDate:"",title:"",trigger:"",value:""},activeTypeFilter:""}},computed:{...(0,r.Se)(["billingDashboard","getCurrentCustomer","isJusttoAdmin","isAdminProfile","tableLoading","transactions","workspaceId"]),filterTransactionsActionParams(){return{icon:"eye",label:"Ver lançamentos",trigger:"showTransactions",visible:!0}},filterDisputesActionParams(){return{icon:"management",label:"Visualizar disputas no gerenciamento",trigger:"showDisputes",visible:!0}},addTransactionActionParams(){return{icon:"add",label:"Criar lançamento manual",trigger:"addTransaction",visible:this.isJusttoAdmin}},tableSubtitle(){return this.tableLoading?`Buscando lançamentos para ${this.activeTypeFilter.toUpperCase()}`:this.activeTypeFilter?`Exibindo ${this.transactionsList.length} de ${this.transactions.totalElements||0} resultados para o filtro ${this.activeTypeFilter.toUpperCase()}`:"Selecione um tipo de lançamento para exibir"},transactionsList(){return this.transactions.content?this.transactions.content:[]},transactionsPagination(){const i=JSON.parse(JSON.stringify(this.transactions));return delete i.content,i},dataCards(){return this.billingDashboard.length?this.billingDashboard.map((i=>"OTHERS"===i.type?{data:i,actions:[this.filterTransactionsActionParams,this.addTransactionActionParams]}:"SUBSCRIPTION"===i.type?{data:i,actions:[this.filterTransactionsActionParams]}:{data:i,actions:[this.filterTransactionsActionParams,this.filterDisputesActionParams]})):null},totalCard(){let i=0,t=0;if(this.billingDashboard)for(const e of Array.from(this.billingDashboard))i+=e.revenue,t+=e.total;return{data:{type:"",title:"total",revenue:i,total:t},actions:[this.filterTransactionsActionParams]}},initialDateRange(){return[this.$moment(new Date).startOf("month").format("YYYY-MM-DD"),this.$moment(new Date).endOf("month").format("YYYY-MM-DD")]}},watch:{workspaceId(i,t,e){i!==e&&this.$router.push("/billing")}},created(){this.dateRange[0]=this.initialDateRange[0],this.dateRange[1]=this.initialDateRange[1],this.clearTransactionsQuery(this.initialDateRange),this.setCustomerId(this.$route.params.customerId),this.setWorkspaceId(this.workspaceId),this.getBillingDashboard(),this.isJusttoAdmin||this.isAdminProfile||(this.$router.go(-1),this.$jusNotification({title:"Ops!",message:"Você não pode entra ai. Fale com um administrador",type:"warning"}))},methods:{...(0,r.nv)(["cancelTransaction","clearTransactionsQuery","patchTransaction","getBillingDashboard","getTransactions","postTransaction","setCustomerId","setManagementFilters","setRangeDate","setTerm","setType","setWorkspaceId"]),filterByTerm(){clearTimeout(this.termDebounce),this.termDebounce=setTimeout((()=>{this.setTerm(this.searchTerm)}),800)},filterByRangeDate(){clearTimeout(this.rangeDebounce),this.rangeDebounce=setTimeout((()=>{this.setRangeDate(this.dateRange)}),800),this.activeTypeFilter=this.activeTypeFilter?this.activeTypeFilter:"TOTAL"},handlerAction(i){const t=i.eventProps.trigger+"Action";this[t](i)},showTransactionsAction(i){const t="OTHERS"!==i.eventProps.customProps.type?i.eventProps.customProps.type:"MANUAL";this.activeTypeFilter=i.eventProps.customProps.title,this.setType(t)},showDisputesAction(i){const t=i.eventProps.customProps.type,e=this.$router.resolve({name:"allDisputes",query:{status:[],startDate:this.dateRange[0],finishDate:this.dateRange[1],transactionType:t,prescription:"BILLING_TRANSACTION",disputeHasFilters:!0,disputeTab:3}});window.open(e.href,"_blank")},handlerModalTrigger(i){this[i]()},addTransactionAction(i){this.addTransactionForm.note="",this.addTransactionForm.occurredDate=this.$moment(new Date).format("YYYY-MM-DD"),this.addTransactionForm.title="Adicionar Lançamento",this.addTransactionForm.trigger=i.eventProps.trigger,this.addTransactionForm.value="",this.addTransactionDialogVisable=!0},addTransaction(){this.modalLoading=!0;const i=this.addTransactionForm;delete i.title,delete i.trigger,this.postTransaction(i).then((()=>{this.$jusNotification({type:"success",title:"Yay!",message:"Lançamento realizado com sucesso"})})).finally((()=>{this.modalLoading=!1,this.addTransactionDialogVisable=!1}))},editTransactionAction(i){const{customProps:{id:t,note:e,occurredDate:a,value:n},trigger:o}=i.eventProps;this.addTransactionForm={id:t,note:e,occurredDate:a,title:"Editar lançamento",trigger:o,value:n},this.addTransactionDialogVisable=!0},editTransaction(){this.modalLoading=!0;const i=this.addTransactionForm;delete i.title,delete i.trigger,this.patchTransaction(i).then((()=>{this.$jusNotification({type:"success",title:"Yay!",message:"Lançamento editado com sucesso"})})).finally((()=>{this.modalLoading=!1,this.addTransactionDialogVisable=!1}))},cancelTransactionAction(i){this.$prompt("Insira o motivo do cancelamento","Cancelar lançamento",{confirmButtonText:"Continuar",cancelButtonText:"Cancelar"}).then((({value:t})=>{this[i.eventProps.trigger]({id:i.eventProps.customProps.id,data:{reason:t}}).then((()=>{this.$jusNotification({type:"success",title:"Yay!",message:"Lançamento cancelado com sucesso"})})).catch((i=>{this.$jusNotification({error:i})}))}))},infiniteHandler(i){this.getTransactions("isInfinit").then((t=>{t.last?i.complete():i.loaded()}))}}},c=s,d=(e(79558),e(59107),e(1001)),g=(0,d.Z)(c,a,n,!1,null,"01992ba6",null),u=g.exports},39812:function(i,t,e){"use strict";e.r(t);var a=e(87537),n=e.n(a),o=e(23645),l=e.n(o),r=l()(n());r.push([i.id,".billing-view[data-v-01992ba6]{overflow:auto}.billing-view .billing-view__slot-main[data-v-01992ba6]{height:100%;display:grid;grid-template-rows:repeat(2,auto) minmax(400px,1fr);gap:20px;position:relative}.billing-view .billing-view__slot-main .billing-view__back-button[data-v-01992ba6]{position:absolute;top:10px;left:10px}.billing-view .billing-view__slot-main .billing-view__range[data-v-01992ba6]{display:flex;align-items:center;justify-content:center}.billing-view .billing-view__slot-main .billing-view__range .billing-view__range-input[data-v-01992ba6]{border:none!important}.billing-view .billing-view__slot-main .billing-view__range .billing-view__range-input .el-range-input[data-v-01992ba6]{font-size:30px;font-weight:700!important}.billing-view .billing-view__slot-main .billing-view__range .billing-view__range-title[data-v-01992ba6]{margin:0;font-size:24px}.billing-view .billing-view__slot-main .billing-view__table[data-v-01992ba6]{padding-top:8px;display:grid;gap:8px;grid-template-rows:auto 1fr}.billing-view .billing-view__slot-main .billing-view__table .billing-view__table-header[data-v-01992ba6]{display:flex;align-items:center;justify-content:flex-start}.billing-view .billing-view__slot-main .billing-view__table .billing-view__table-header .billing-view__table-filter-input[data-v-01992ba6]{width:300px;margin-right:8px}","",{version:3,sources:["webpack://./src/views/main/billing/BillingDashboard.vue"],names:[],mappings:"AACA,+BACE,aAAA,CAEA,wDACE,WAAA,CACA,YAAA,CACA,mDAAA,CACA,QAAA,CACA,iBAAA,CAEA,mFACE,iBAAA,CACA,QAAA,CACA,SAAA,CAGF,6EACE,YAAA,CACA,kBAAA,CACA,sBAAA,CAEA,wGACE,qBAAA,CAEA,wHACE,cAAA,CACA,yBAAA,CAIJ,wGACE,QAAA,CACA,cAAA,CAIJ,6EACE,eAAA,CACA,YAAA,CACA,OAAA,CACA,2BAAA,CAEA,yGACE,YAAA,CACA,kBAAA,CACA,0BAAA,CAEA,2IACE,WAAA,CACA,gBAAA",sourcesContent:["\n.billing-view {\n  overflow: auto;\n\n  .billing-view__slot-main {\n    height: 100%;\n    display: grid;\n    grid-template-rows: repeat(2, auto) minmax(400px, 1fr);\n    gap: 20px;\n    position: relative;\n\n    .billing-view__back-button {\n      position: absolute;\n      top: 10px;\n      left: 10px;\n    }\n\n    .billing-view__range {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n\n      .billing-view__range-input {\n        border: none !important;\n\n        .el-range-input {\n          font-size: 30px;\n          font-weight: bold !important;\n        }\n      }\n\n      .billing-view__range-title {\n        margin: 0px;\n        font-size: 24px;\n      }\n    }\n\n    .billing-view__table {\n      padding-top: 8px;\n      display: grid;\n      gap: 8px;\n      grid-template-rows: auto 1fr;\n\n      .billing-view__table-header {\n        display: flex;\n        align-items: center;\n        justify-content: flex-start;\n\n        .billing-view__table-filter-input  {\n          width: 300px;\n          margin-right: 8px;\n        }\n      }\n    }\n  }\n}\n"],sourceRoot:""}]),t["default"]=r},48844:function(i,t,e){"use strict";e.r(t);var a=e(87537),n=e.n(a),o=e(23645),l=e.n(o),r=l()(n());r.push([i.id,".billing-view .billing-view__slot-main .billing-view__range .billing-view__range-input{padding:4px 0;margin:0 4px!important;width:298px}.billing-view .billing-view__slot-main .billing-view__range .billing-view__range-input .el-icon-date,.billing-view .billing-view__slot-main .billing-view__range .billing-view__range-input .el-range__close-icon{display:none}.billing-view .billing-view__slot-main .billing-view__range .billing-view__range-input .el-range-input,.billing-view .billing-view__slot-main .billing-view__range .billing-view__range-input .el-range-separator{font-size:24px;font-weight:700;color:#0756e4;cursor:pointer}.billing-view .billing-view__slot-main .billing-view__range .billing-view__range-input .el-range-input{width:140px}.billing-view .billing-view__slot-main .billing-view__range .billing-view__range-input .el-range-separator{width:18px}.billing-view .billing-view__slot-main .billing-view__table .billing-view__table-body .el-card__body{padding:16px;height:100%}.billing-view .el-date-editor.el-input{width:100%}.billing-view .el-card__body{height:100%}","",{version:3,sources:["webpack://./src/views/main/billing/BillingDashboard.vue","webpack://./node_modules/projuris-acordos-theme/src/common/colors.scss"],names:[],mappings:"AAMM,uFACE,aAAA,CACA,sBAAA,CACA,WAAA,CAEA,kNACE,YAAA,CAGF,kNACE,cAAA,CACA,eAAA,CACA,aCNQ,CDOR,cAAA,CAGF,uGACE,WAAA,CAGF,2GACE,UAAA,CAOF,qGACE,YAAA,CACA,WAAA,CAMR,uCACE,UAAA,CAGF,6BACE,WAAA",sourcesContent:["\n@import '~projuris-acordos-theme/src/common/colors.scss';\n\n.billing-view {\n  .billing-view__slot-main {\n    .billing-view__range {\n      .billing-view__range-input {\n        padding: 4px 0;\n        margin: 0 4px !important;\n        width: 298px;\n\n        .el-icon-date, .el-range__close-icon {\n          display: none;\n        }\n\n        .el-range-input, .el-range-separator {\n          font-size: 24px;\n          font-weight: bold;\n          color: $--color-primary;\n          cursor: pointer;\n        }\n\n        .el-range-input {\n          width: 140px\n        }\n\n        .el-range-separator {\n          width: 18px;\n        }\n      }\n    }\n\n    .billing-view__table {\n      .billing-view__table-body {\n        .el-card__body {\n          padding: 16px;\n          height: 100%;\n        }\n      }\n    }\n  }\n\n  .el-date-editor.el-input {\n    width: 100%;\n  }\n\n  .el-card__body {\n    height: 100%;\n  }\n}\n","/* Colors\n-------------------------- */\n\n$--color-white: #fff !default;\n$--color-black: #424242 !default;\n$--color-gray: #979797 !default;\n$--color-gray-light-1: mix($--color-white, $--color-gray, 10%) !default;\n$--color-light-gray: #f3f4f5 !default;\n$--color-whatsapp: #075E54 !default;\n\n$--pj-color-darker-blue: #0A0022 !default;\n$--pj-color-dark-blue: #280BA0 !default;\n$--pj-color-blue: #0756e4 !default;\n$--pj-color-light-blue: #018EF0 !default;\n$--pj-color-lighter-blue: #30A9FB !default;\n$--pj-color-white-blue: #F0F9FE !default;\n$--pj-color-disabled-blue: #9ad2f9 !default;\n\n$-pg-color-overlay: #19415F !default;\n\n$--pj-color-red: #CC4148 !default;\n$--pj-color-light-red: #EC767C !default;\n$--pj-color-disable-red: #FFF2F3 !default;\n\n$--color-primary: $--pj-color-blue !default;\n$--color-primary-light-1: mix($--color-white, $--color-primary, 10%) !default;\n$--color-primary-light-2: mix($--color-white, $--color-primary, 20%) !default;\n$--color-primary-light-3: mix($--color-white, $--color-primary, 30%) !default;\n$--color-primary-light-4: mix($--color-white, $--color-primary, 40%) !default;\n$--color-primary-light-5: mix($--color-white, $--color-primary, 50%) !default;\n$--color-primary-light-6: mix($--color-white, $--color-primary, 60%) !default;\n$--color-primary-light-7: mix($--color-white, $--color-primary, 70%) !default;\n$--color-primary-light-8: mix($--color-white, $--color-primary, 80%) !default;\n$--color-primary-light-9: mix($--color-white, $--color-primary, 90%) !default;\n\n$--color-secondary: $--pj-color-light-blue !default;\n$--color-secondary-light-1: mix($--color-white, $--color-secondary, 10%) !default;\n$--color-secondary-light-2: mix($--color-white, $--color-secondary, 20%) !default;\n$--color-secondary-light-3: mix($--color-white, $--color-secondary, 30%) !default;\n$--color-secondary-light-4: mix($--color-white, $--color-secondary, 40%) !default;\n$--color-secondary-light-5: mix($--color-white, $--color-secondary, 50%) !default;\n$--color-secondary-light-6: mix($--color-white, $--color-secondary, 60%) !default;\n$--color-secondary-light-7: mix($--color-white, $--color-secondary, 70%) !default;\n$--color-secondary-light-8: mix($--color-white, $--color-secondary, 80%) !default;\n$--color-secondary-light-9: mix($--color-white, $--color-secondary, 90%) !default;\n\n$--color-primary-dark: $--pj-color-dark-blue !default;\n$--color-success: #14CC30 !default;\n$--color-warning: #FFC900 !default;\n$--color-danger: #FF4B54 !default;\n$--color-info: #2FBBEC !default;\n\n$--color-success-light-1: mix($--color-white, $--color-success, 10%) !default;\n$--color-success-light-5: mix($--color-white, $--color-success, 50%) !default;\n$--color-warning-light-5: mix($--color-white, $--color-warning, 50%) !default;\n$--color-danger-light-5: mix($--color-white, $--color-danger, 50%) !default;\n$--color-danger-light-3: mix($--color-white, $--color-danger, 30%) !default;\n$--color-info-light-5: mix($--color-white, $--color-info, 50%) !default;\n\n$--color-success-light: mix($--color-white, $--color-success, 80%) !default;\n$--color-warning-light: mix($--color-white, $--color-warning, 80%) !default;\n$--color-danger-light: mix($--color-white, $--color-danger, 80%) !default;\n$--color-info-light: mix($--color-white, $--color-info, 80%) !default;\n\n$--color-success-lighter: mix($--color-white, $--color-success, 90%) !default;\n$--color-warning-lighter: mix($--color-white, $--color-warning, 90%) !default;\n$--color-danger-lighter: mix($--color-white, $--color-danger, 90%) !default;\n$--color-info-lighter: mix($--color-white, $--color-info, 90%) !default;\n\n$--color-text-primary: $--color-black !default;\n$--color-text-secondary: $--color-gray !default;\n\n$--color-nps-promoter: #14CC30 !default;\n$--color-nps-neutral: #979797 !default;\n$--color-nps-detractor: #FF4B54 !default;\n\n$--color-negotiator-bg: #9461f74f !default;\n$--color-email-bg: $--color-info-light !default;\n$--color-whatsapp-bg: $--color-success-light-5 !default;"],sourceRoot:""}]),t["default"]=r},79558:function(i,t,e){var a=e(39812);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[i.id,a,""]]),a.locals&&(i.exports=a.locals);var n=e(39185).Z;n("41e1edfd",a,!0,{sourceMap:!0,shadowMode:!1})},59107:function(i,t,e){var a=e(48844);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[i.id,a,""]]),a.locals&&(i.exports=a.locals);var n=e(39185).Z;n("89ba849a",a,!0,{sourceMap:!0,shadowMode:!1})}}]);
//# sourceMappingURL=billingDashboard.js.map